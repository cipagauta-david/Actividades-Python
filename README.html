<html class="hentry" lang="es">

<head>
	<meta http-equiv="content-type" content="text/html; charset=UTF-8">
	<meta http-equiv="content-language" content="es">
	<meta http-equiv="content-script-type" content="text/javascript">
	<meta http-equiv="content-style-type" content="text/css">
	<meta name="description" content="This is the online markdown editor with live preview.">
	<link rel="stylesheet" type="text/css" href="css/style.css?v=">
	<link rel="icon" type="image/png" href="favicon.png">
	<title>Markdown Live Preview</title>
	<script type="module" crossorigin="" src="/assets/index-DXVBtf7Z.js"></script>
	<link rel="stylesheet" crossorigin="" href="/assets/index-C-vOJggO.css">
	<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-77C 1GEG9C8"></script>
	<link class="tempLink" rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto">
	<style id="rm-custom-highlight-color-styles"></style>
</head>

<body class="enable-motion underline-links entry-content" lang="es" data-rm-theme="light">
	<div id="output" class="content markdown-body">
		<h3><strong>Catálogo de Casos de Uso del Sistema de Soporte Inteligente</strong></h3>
		<table>
			<thead>
				<tr>
					<th align="left"><strong>ID del Caso de Uso</strong></th>
					<th align="left">UC-0 1</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td align="left"> <strong>Nombre</strong><br>$</td>
					<td align="left"> Enviar PQRS vía Formulario Web<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Actor Primario</strong><br>$</td>
					<td align="left"> Cliente<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Actor Secundario(s)</strong><br>$</td>
					<td align="left"> <strong>Sistema</strong> (Para invocar <code>UC-23: Crear Ticket</code>)<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Objetivos asociados</strong><br>$</td>
					<td align="left">
						<ol>
							<li><strong>Optimizar la Eficiencia Operativa:</strong> Asegurar que los datos de entrada estén validados
								y completos para facilitar el procesamiento automático y reducir el TTR. </li>
							<li><strong>Mejorar y Estandarizar la Experiencia del Cliente (CX):</strong> Ofrecer un canal estructurado
								que guía al cliente a proporcionar la información clave desde el inicio, estandarizando la calidad del
								servicio. </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Requisitos asociados</strong><br>$</td>
					<td align="left"> <strong>Funcionales:</strong>
						<ul>
							<li><strong>RF-TICKET-002:</strong> Especifica la creación de un <code>Ticket</code> y
								<code>Mensaje</code> desde el formulario.
							</li>
							<li><strong>RF-TICKET-004:</strong> Define la asociación o creación de un <code>Cliente</code>. </li>
							<li><strong>RF-TICKET-005:</strong> Menciona la vinculación opcional a una <code>Orden</code> existente.
							</li>
							<li><strong>RF-TICKET-006:</strong> Exige el envío de un acuse de recibo por correo. </li>
							<li><strong>RF-IA-00 1:</strong> Indica que la creación del ticket debe iniciar el procesamiento de la
								IA.<br><br><strong>Interfaces:</strong> </li>
							<li><strong>COM-0 1:</strong> Toda la comunicación debe ser a través de HTTPS. </li>
						</ul>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Descripción</strong><br>$</td>
					<td align="left"> El Cliente, un usuario final de GearUp Gadgets, accede a un formulario público en el sitio
						web para enviar una solicitud de soporte. El cliente completa los campos requeridos, adjunta archivos
						opcionalmente y envía el formulario. El sistema valida los datos, crea un ticket y notifica al cliente que
						su solicitud ha sido recibida.<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Precondición</strong><br>$</td>
					<td align="left">
						<ol>
							<li>El Cliente tiene acceso a un navegador web y conexión a internet. </li>
							<li>El Cliente conoce la URL de la página de soporte de GearUp Gadgets. </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Secuencia Normal (Flujo Principal)</strong><br>$</td>
					<td align="left">
						<ol>
							<li>El <strong>Cliente</strong> navega a la página de soporte y accede al formulario de contacto. </li>
							<li>El <strong>Sistema</strong> presenta el formulario web con los siguientes campos: Nombre Completo
								(requerido), Email de Contacto (requerido, debe ser un formato de email válido), ID de Orden (opcional),
								Asunto (requerido), Mensaje (requerido), Adjuntar Archivo(s) (opcional). </li>
							<li>El <strong>Cliente</strong> completa la información solicitada en el formulario. </li>
							<li>El <strong>Cliente</strong> hace clic en el botón "Enviar Solicitud". </li>
							<li>El <strong>Sistema</strong> realiza una validación de los datos en el navegador (client-side) para
								asegurar que los campos requeridos están completos y el formato del email es correcto. </li>
							<li>El navegador del <strong>Cliente</strong> envía los datos del formulario de forma segura (vía HTTPS)
								al backend de NoraAI. </li>
							<li>El <strong>Sistema</strong> recibe la solicitud e invoca el proceso interno
								<strong><code>UC-23: Crear Ticket</code></strong>. Este proceso se encarga de: <ol type="a">
									<li>Realizar una validación de seguridad y de negocio de los datos (server-side). </li>
									<li>Crear o encontrar el registro del <code>Cliente</code> basado en el email. </li>
									<li>Crear el registro del <code>Ticket</code> y el <code>Mensaje</code> inicial. </li>
									<li>Vincular el <code>Ticket</code> a una <code>Orden</code> si se proporcionó un ID de orden válido.
									</li>
									<li>Almacenar los archivos adjuntos (si los hay) y vincularlos al <code>Mensaje</code>. </li>
									<li>Tras la creación exitosa del ticket, el <strong>Sistema</strong> dispara dos acciones en paralelo:
										<ol type="a">

											<li>Inicia el proceso en segundo plano para el análisis con IA (<code>RF-IA-001</code>). </li>
											<li>Envía un correo electrónico de acuse de recibo al <strong>Cliente</strong>
												(<code>RF-TICKET-006</code>). </li>
										</ol>
									</li>
								</ol>
							</li>
							<li>El <strong>Sistema</strong> redirige al <strong>Cliente</strong> a una página de confirmación
								mostrando un mensaje de éxito: "¡Gracias! Hemos recibido tu solicitud. Tu número de ticket es
								[ID
								del Ticket]. Recibirás una confirmación en tu correo electrónico en breve." </li>

						</ol>
					<br>$</td>
				</tr>

				<tr>
					<td align="left"> <strong>Postcondición</strong><br>$</td>
					<td align="left">
						<ol>
							<li>Se ha creado un nuevo registro de <code>Ticket</code> y <code>Mensaje</code> en la base de datos.
							</li>
							<li>El <code>Ticket</code> está en el estado inicial <code>pendiente_ia</code>, listo para ser procesado.
							</li>
							<li>Se ha enviado un correo de acuse de recibo a la dirección proporcionada por el cliente. </li>
							<li>El cliente ve una página de confirmación en su navegador. </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Excepciones (Flujos Alternativos)</strong><br>$</td>
					<td align="left">
						<ul>

							<strong>E1: Falla la validación de datos.</strong>
							<li> En el paso 5, el Cliente envía el formulario con datos inválidos (ej. email mal formado, campo
								requerido vacío).</li>
							<li> El Sistema no envía la solicitud. En su lugar, resalta los campos con errores y muestra mensajes
								descriptivos junto a ellos (ej. "Por favor, introduce una dirección de correo válida."). Los datos que
								sí eran correctos se conservan en el formulario.<br><br></li>

							<strong>E2: Falla la comunicación con el servidor.</strong>
							<li> En el paso 6, ocurre un error de red o el servidor no está disponible. </li>
							<li> El Sistema muestra un mensaje de error genérico en la página del formulario: "Lo sentimos, no hemos
								podido procesar tu solicitud en este momento. Por favor, inténtalo de nuevo más tarde o contáctanos
								directamente por correo electrónico."<br><br> </li>

							<strong>E3: Falla el proceso de creación del ticket.</strong>
							<li> En el paso 7, el backend no puede crear el ticket por una razón interna (ej. error de base de datos).
							</li>
							<li> El Sistema registra el error internamente para su auditoría y devuelve una respuesta de error al
								frontend.</li>
							<li> El frontend muestra el mismo mensaje de error genérico descrito en E2. </li>
						</ul>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Rendimiento</strong><br>$</td>
					<td align="left"> La respuesta del sistema tras el envío del formulario (paso 9) debe mostrarse al cliente en
						<strong>menos de 3 segundos</strong> bajo condiciones de carga normales.
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Frecuencia</strong><br>$</td>
					<td align="left"> Media-Alta. Se anticipa que será un canal de entrada principal para nuevos clientes o para
						problemas no relacionados con una conversación de correo electrónico existente.<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Comentarios</strong><br>$</td>
					<td align="left">
						<li>Es imperativo que el formulario esté protegido contra spam (ej. utilizando un CAPTCHA invisible o un
							honeypot) para evitar la creación masiva de tickets basura. </li>
						<li>La validación de datos debe existir tanto en el frontend (para una experiencia de usuario fluida) como
							en el backend (por seguridad y para garantizar la integridad de los datos). </li>
					<br>$</td>
				</tr>
				<tr>
					<td>$<br>$</td>
					<td>$<br>$</td>
				</tr>
				<tr>
					<td>$<br>$</td>
					<td>$<br>$</td>
				</tr>
			</tbody>
			<thead>
				<tr>
					<th align="left"><strong>ID del Caso de Uso</strong></th>
					<th align="left">UC-02</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td align="left"> <strong>Nombre</strong><br>$</td>
					<td align="left"> Enviar PQRS vía Email<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Actor Primario</strong><br>$</td>
					<td align="left"> Cliente<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Actor Secundario(s)</strong><br>$</td>
					<td align="left"> <strong>Sistema de Email (Mailgun)</strong>, <strong>Sistema</strong> (Para invocar
						<code>UC-25: Notificar Nuevo Email</code>)
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Objetivos asociados</strong><br>$</td>
					<td align="left">
						<ol>
							<li><strong>Mejorar y Estandarizar la Experiencia del Cliente (CX):</strong> Proveer un canal de soporte
								universal y de baja fricción. </li>
							<li><strong>Optimizar la Eficiencia Operativa:</strong> Traducir de forma fiable cada correo electrónico
								entrante en un ticket estructurado, automatizando la creación de tickets. </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Requisitos asociados</strong><br>$</td>
					<td align="left"> <strong>Funcionales:</strong>
						<ul>
							<li><strong>RF-TICKET-00 1:</strong> El sistema deberá crear un ticket al recibir una solicitud vía
								webhook de Mailgun. </li>
							<li><strong>RF-TICKET-003:</strong> El sistema debe ser capaz de diferenciar un nuevo correo de una
								respuesta (este UC cubre el caso del nuevo correo).
							</li>
							<li><strong>RF-TICKET-004:</strong> Se debe asociar cada ticket a un <code>Cliente</code>. </li>
							<li><strong>RF-TICKET-006:</strong> El sistema debe enviar un correo de acuse de recibo. </li>
							<li><strong>RF-FILE-00 1:</strong> El sistema debe procesar los archivos
								adjuntos.<br><br><strong>Interfaces:</strong> </li>
							<li><strong>API-02:</strong> El sistema debe exponer un endpoint de webhook para Mailgun. </li>

						</ul>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Descripción</strong><br>$</td>
					<td align="left"> El Cliente redacta y envía un correo electrónico (Petición, Queja, Reclamo o Sugerencia) a
						la dirección de soporte designada por GearUp Gadgets. Esta acción, externa a NoraAI, desencadena un proceso
						automático que recibe el correo, lo convierte en un nuevo ticket de soporte dentro del sistema y notifica al
						cliente que su solicitud ha sido registrada.<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Precondición</strong><br>$</td>
					<td align="left">
						<ol>
							<li>El Cliente conoce la dirección de correo electrónico de soporte (ej.
								<code>soporte@gearupgadgets.com</code>).
							</li>
							<li>La infraestructura de recepción de correo del sistema (registros DNS MX, configuración de Mailgun, y
								el endpoint del webhook) está correctamente configurada y operativa.</li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Secuencia Normal (Flujo Principal)</strong><br>$</td>
					<td align="left">
						<ol>
							<li>El <strong>Cliente</strong> utiliza su programa de correo preferido para redactar y enviar un email a
								la dirección de soporte. El email contiene un asunto, un cuerpo y, opcionalmente, archivos adjuntos.
								(Esta acción es externa al sistema NoraAI). </li>
							<li>El <strong>Proveedor de Email (Mailgun)</strong> recibe el correo electrónico enviado por el cliente.
							</li>
							<li>El <strong>Proveedor de Email</strong> invoca inmediatamente el webhook configurado en NoraAI
								(<code>API-02</code>), enviando una solicitud HTTP POST con el contenido completo del correo (remitente,
								destinatarios, asunto, cuerpo, adjuntos, etc.) en un formato JSON estructurado. </li>
							<li>El <strong>Sistema</strong> recibe la solicitud en su endpoint de webhook e invoca el proceso
								<strong><code>UC-25: Notificar Nuevo Email</code></strong>.
							</li>
							<li>El proceso <code>UC-25</code> analiza las cabeceras del correo y, al no encontrar un
								<code>In-Reply-To</code> o un ID de ticket de referencia, determina que se trata de una nueva solicitud.
							</li>
							<li>El <strong>Sistema</strong> invoca el proceso <strong><code>UC-23: Crear Ticket</code></strong>, que
								se encarga de: <ol type="a">
									<li>Validar y limpiar los datos recibidos del webhook. </li>
									<li>Crear o encontrar el registro del <code>Cliente</code> basado en el email del remitente. </li>
									<li>Crear un nuevo <code>Ticket</code> y el <code>Mensaje</code> inicial a partir del cuerpo del
										correo. </li>
									<li>Procesar, almacenar y asociar los archivos adjuntos al <code>Mensaje</code>. </li>
									<li>Tras la creación exitosa del ticket, el <strong>Sistema</strong> dispara dos acciones en paralelo:
										<ol type="a">

											<li>Inicia el proceso en segundo plano para el análisis con IA (<code>RF-IA-001</code>). </li>
											<li>Envía un correo electrónico de acuse de recibo al <strong>Cliente</strong>, incluyendo el ID
												único
												del nuevo ticket (<code>RF-TICKET-006</code>). </li>
										</ol>
									</li>
								</ol>
							</li>
						</ol>
					<br>$</td>
				</tr>

				<tr>
					<td align="left"> <strong>Postcondición</strong><br>$</td>
					<td align="left">
						<ol>
							<li>Se ha creado un nuevo <code>Ticket</code> con su <code>Mensaje</code> inicial en la base de datos.
							</li>
							<li>El <code>Ticket</code> se encuentra en el estado <code>pendiente_ia</code>. </li>
							<li>Los archivos adjuntos, si los había, están almacenados y asociados al ticket. </li>
							<li>El <code>Cliente</code> ha recibido un correo de confirmación con el número de su ticket. </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Excepciones (Flujos Alternativos)</strong><br>$</td>
					<td align="left">
						<ul>
							<strong>E1: El email es identificado como spam.</strong>
							<li> En el paso 3, el Proveedor de Email marca el correo con una alta probabilidad de ser spam. </li>
							<li> El Sistema recibe el webhook con esta información. </li>
							<li> En lugar de crear un ticket normal, el sistema puede estar configurado para: a) descartarlo
								silenciosamente, o b) crearlo con un estado especial <code>spam</code> para revisión manual, evitando
								que entre en la cola de trabajo principal.<br><br>
								<strong>E2: Falla la entrega del webhook.</strong>
							</li>
							<li> El endpoint de NoraAI no está disponible cuando Mailgun intenta enviar la notificación. </li>
							<li> Mailgun intentará reenviar el webhook varias veces según su política de reintentos.<br>
							</li>
							<li>Desde la perspectiva del cliente, habrá un retraso en recibir el acuse de recibo. Si el problema
								persiste, nunca lo recibirá. El sistema debe tener monitoreo sobre su endpoint para detectar estas
								fallas.<br><br>
								<strong>E3: Falla el procesamiento interno del ticket.</strong>
							</li>

							<li> En el paso 6, ocurre un error interno (ej. la base de datos está caída). </li>
							<li> El Sistema debe registrar el error detallado para la depuración y responder al webhook con un código
								de error del servidor (ej. <code>5xx</code>). Esto le indica a Mailgun que la entrega falló y que debe
								reintentar más tarde.<br><br>
								<strong>E4: El email es una respuesta a un ticket existente.</strong>
							</li>
							<li> En el paso 5, el sistema detecta cabeceras como <code>In-Reply-To</code> o un ID de ticket en el
								asunto. </li>
							<li> El flujo de ejecución se desvía al caso de uso
								<strong><code>UC-03: Responder a un Ticket (Correo) Existente</code></strong>, y no se crea un nuevo
								ticket.
							</li>
						</ul>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Rendimiento</strong><br>$</td>
					<td align="left"> El tiempo transcurrido desde que el sistema recibe el webhook (paso 4) hasta que el cliente
						recibe el correo de acuse de recibo (paso 7b) debe ser, en promedio, <strong>inferior a 60
							segundos</strong>.<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Frecuencia</strong><br>$</td>
					<td align="left"> Muy Alta. Se espera que este sea el principal canal de entrada de solicitudes de soporte.
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Comentarios</strong><br>$</td>
					<td align="left">
						<li>La fiabilidad de este flujo depende críticamente de la correcta configuración de los registros DNS (MX,
							SPF, DKIM) del dominio <code>gearupgadgets.com</code> para asegurar la correcta recepción y autenticidad
							de los correos. </li>
						<li>La lógica para diferenciar entre un nuevo correo y una respuesta (E4) es una de las reglas de negocio
							más importantes para evitar la duplicación de tickets. </li>
					<br>$</td>
				</tr>
				<tr>
					<td>$<br>$</td>
					<td>$<br>$</td>
				</tr>
				<tr>
					<td>$<br>$</td>
					<td>$<br>$</td>
				</tr>
			</tbody>
			<thead>
				<tr>
					<th align="left"><strong>ID del Caso de Uso</strong></th>
					<th align="left">UC-03</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td align="left"> <strong>Nombre</strong><br>$</td>
					<td align="left"> Responder a un Ticket (Correo) Existente<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Actor Primario</strong><br>$</td>
					<td align="left"> Cliente<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Actor Secundario(s)</strong><br>$</td>
					<td align="left"> <strong>Sistema de Email (Mailgun)</strong>, <strong>Sistema</strong> (Para actualizar el
						<code>Ticket</code>)
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Objetivos asociados</strong><br>$</td>
					<td align="left">
						<ol>
							<li><strong>Optimizar la Eficiencia Operativa:</strong> Evitar la creación de tickets duplicados y
								reactivar casos en espera, manteniendo un flujo de trabajo limpio. </li>
							<li><strong>Mejorar y Estandarizar la Experiencia del Cliente (CX):</strong> Asegurar la continuidad de la
								conversación en un único hilo, creando una interacción fácil de seguir. </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Requisitos asociados</strong><br>$</td>
					<td align="left"> <strong>Funcionales:</strong>
						<ul>
							<li><strong>RF-TICKET-003:</strong> Identificar si un correo entrante es una respuesta a un ticket
								existente y agregarlo como un <code>Mensaje</code> a ese ticket.
							</li>
							<li><strong>RF-FILE-00 1:</strong> Procesar los archivos adjuntos en la
								respuesta.<br><br><strong>Interfaces:</strong> </li>
							<li><strong>API-02:</strong> Utiliza el mismo webhook de Mailgun que <code>UC-02</code> para recibir el
								correo. </li>

						</ul>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Descripción</strong><br>$</td>
					<td align="left"> Un Cliente responde a un correo electrónico que forma parte de una conversación de soporte
						existente (un ticket). El sistema debe ser capaz de identificar a qué ticket pertenece la respuesta y añadir
						el contenido del correo como un nuevo mensaje dentro de ese ticket, en lugar de crear uno nuevo.<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Precondición</strong><br>$</td>
					<td align="left">
						<ol>
							<li>Existe un <code>Ticket</code> en el sistema asociado al <code>Cliente</code>. </li>
							<li>El Cliente ha recibido previamente al menos un correo electrónico del sistema relacionado con ese
								ticket (ej. el acuse de recibo o una respuesta de un agente).</li>
							<li>El Cliente utiliza la función "Responder" de su cliente de correo. </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Secuencia Normal (Flujo Principal)</strong><br>$</td>
					<td align="left">
						<ol>
							<li>El <strong>Cliente</strong> responde a un correo electrónico del ticket. (Acción externa al sistema).
							</li>
							<li>El <strong>Proveedor de Email (Mailgun)</strong> recibe el correo y, al igual que en
								<code>UC-02</code>, invoca el webhook de NoraAI (<code>API-02</code>) con los datos del email.
							</li>
							<li>El <strong>Sistema</strong> recibe la solicitud en su endpoint de webhook e invoca el proceso
								<strong><code>UC-25: Notificar Nuevo Email</code></strong>.
							</li>
							<li>El proceso <code>UC-25</code> analiza las cabeceras del correo. Detecta la presencia de una cabecera
								<code>In-Reply-To</code> o <code>References</code>, o un identificador de ticket (ej.
								<code>[TICKET-12345]</code>) en el asunto.
							</li>
							<li>Usando esta información, el <strong>Sistema</strong> busca y encuentra el <code>Ticket</code>
								correspondiente en la base de datos. </li>
							<li>El <strong>Sistema</strong> ejecuta las siguientes acciones: <ol type="a">
									<li>Crea un nuevo registro de <code>Mensaje</code> con el contenido del cuerpo del correo y lo asocia
										al <code>Ticket</code> encontrado. </li>
									<li>Procesa y almacena cualquier archivo adjunto, asociándolo al nuevo <code>Mensaje</code>. </li>
									<li>Actualiza el estado del <code>Ticket</code>. Típicamente, si el estado era
										<code>esperando_cliente</code>, lo cambia a <code>abierto</code> (o <code>pendiente_triaje</code> si
										se requiere nueva evaluación de la IA).
									</li>
								</ol>
							</li>
							<li>El <strong>Sistema</strong> notifica a los agentes suscritos (o al agente asignado) que el ticket
								ha recibido una nueva respuesta del cliente. </li>
						</ol>
					<br>$</td>
				</tr>

				<tr>
					<td align="left"> <strong>Postcondición</strong><br>$</td>
					<td align="left">
						<ol>
							<li>No se ha creado ningún ticket nuevo. </li>
							<li>Se ha añadido un nuevo <code>Mensaje</code> al historial del ticket existente. </li>
							<li>El estado del ticket se ha actualizado para reflejar que requiere atención de un agente. </li>
							<li>Los agentes pertinentes son notificados de la actualización. </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Excepciones (Flujos Alternativos)</strong><br>$</td>
					<td align="left">
						<ul>
							<strong>E1: El ID del ticket no se encuentra.</strong>
							<li> El sistema extrae un ID de ticket del asunto o las cabeceras, pero no existe un ticket con ese ID en
								la base de datos (pudo ser un error de tipeo del cliente o un ticket muy antiguo y purgado).</li>
							<li> En este caso, el sistema trata el correo como una nueva solicitud y procede con el flujo de
								<code>UC-02</code> para crear un nuevo ticket. Opcionalmente, puede enviar una notificación de error al
								cliente.<br><br>
								<strong>E2: El ticket está cerrado.</strong>
							</li>
							<li> El cliente responde a un ticket que ya tiene el estado <code>cerrado</code> o <code>resuelto</code>.
							</li>
							<li> El sistema puede estar configurado para: a) reabrir automáticamente el ticket cambiando su estado a
								<code>abierto</code> y añadiendo el mensaje, o b) crear un nuevo ticket "de seguimiento", vinculándolo
								al ticket cerrado original. La opción 'a' suele ser la preferida para MVP.
							</li>
						</ul>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Rendimiento</strong><br>$</td>
					<td align="left"> El procesamiento del webhook y la actualización del ticket deben completarse en
						<strong>menos de 5 segundos</strong>.
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Frecuencia</strong><br>$</td>
					<td align="left"> Muy Alta. Es el flujo natural para cualquier conversación de soporte que requiera más de una
						interacción.<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Comentarios</strong><br>$</td>
					<td align="left">
						<li>La robustez del parser para identificar el ID del ticket (tanto en cabeceras como en el asunto) es
							crucial para el funcionamiento de este caso de uso. El sistema debe ser tolerante a variaciones como "Re:
							[TICKET-123]" o "FWD: [TICKET-123]". </li>
						<li>La política sobre cómo manejar respuestas a tickets cerrados (E2) es una decisión de negocio importante
							que debe ser configurable. </li>
					<br>$</td>
				</tr>
				<tr>
					<td>$<br>$</td>
					<td>$<br>$</td>
				</tr>
				<tr>
					<td>$<br>$</td>
					<td>$<br>$</td>
				</tr>
			</tbody>
			<thead>
				<tr>
					<th align="left"><strong>ID del Caso de Uso</strong></th>
					<th align="left">UC-04</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td align="left"> <strong>Nombre</strong><br>$</td>
					<td align="left"> Aprobar Respuesta Sugerida por la IA<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Actor Primario</strong><br>$</td>
					<td align="left"> Agente de Triaje<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Actor Secundario(s)</strong><br>$</td>
					<td align="left"> <strong>Cliente</strong> (Recibe el mensaje), <strong>Sistema de Email (Mailgun)</strong>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Objetivos asociados</strong><br>$</td>
					<td align="left">
						<ol>
							<li><strong>Optimizar la Eficiencia Operativa:</strong> Reducir drásticamente el Tiempo de Primera
								Respuesta (FRT) y el costo por contacto en consultas de alta frecuencia. </li>
							<li><strong>Reducir el Desgaste del Agente (Agent Burnout):</strong> Permitir que los agentes resuelvan un
								alto volumen de consultas comunes con un esfuerzo mínimo. </li>
							<li><strong>Mejorar y Estandarizar la Experiencia del Cliente (CX):</strong> Asegurar que las respuestas
								sigan un tono y una calidad estandarizados. </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Requisitos asociados</strong><br>$</td>
					<td align="left"> <strong>Funcionales:</strong>
						<ul>
							<li><strong>RF-AGENT-00 1:</strong> La UI de Triaje debe mostrar los tickets con estado
								<code>ia_sugerido</code>.
							</li>
							<li><strong>RF-AGENT-002:</strong> La UI debe presentar la sugerencia de la IA de forma clara para su
								revisión. </li>
							<li><strong>RF-AGENT-003:</strong> Un agente debe poder aprobar la sugerencia con un solo clic, lo cual
								debe enviar el correo y actualizar el estado del ticket.<br><br><strong>No Funcionales:</strong> </li>
							<li><strong>NFR-PERF-003:</strong> La acción de aprobación en 1-clic debe ser percibida como instantánea
								(&lt; 2 segundos).
							</li>
							<li><strong>NFR-USAB-00 1:</strong> La acción debe poder completarse con un solo clic. </li>

						</ul>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Descripción</strong><br>$</td>
					<td align="left"> El Agente de Triaje revisa la respuesta generada automáticamente por la IA para un ticket
						entrante. Si considera que la sugerencia es precisa y completa, la aprueba con un solo clic. Esta acción
						desencadena el envío de la respuesta al cliente y actualiza el estado del ticket, completando el ciclo de
						interacción para esa consulta.<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Precondición</strong><br>$</td>
					<td align="left">
						<ol>
							<li>El actor debe estar autenticado en el sistema y poseer el rol de <code>Agente de Triaje</code> o
								superior. </li>
							<li>Existe un <code>Ticket</code> en el sistema con estado <code>ia_sugerido</code>. </li>
							<li>La IA (<code>UC-24</code>) ya ha generado una propuesta de respuesta para dicho ticket. </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Secuencia Normal (Flujo Principal)</strong><br>$</td>
					<td align="left">
						<ol>
							<li>El <strong>Agente</strong> selecciona un ticket de la cola de triaje en la UI (<code>UI-02</code>).
							</li>
							<li>El <strong>Sistema</strong> muestra la vista de detalle del ticket, presentando el historial de la
								conversación a la izquierda y la respuesta sugerida por la IA a la derecha. </li>
							<li>El <strong>Agente</strong> lee la sugerencia y la valida mentalmente, determinando que es correcta.
							</li>
							<li>El <strong>Agente</strong> hace clic en el botón "Aprobar y Enviar". </li>
							<li>El <strong>Sistema</strong> ejecuta las siguientes acciones en una única transacción: <ol type="a">
									<li>Crea un nuevo <code>Mensaje</code> de salida con el texto de la sugerencia, registrando al Agente
										como <code>aprobadoPorUsuarioId</code>. </li>
									<li>Envía un correo electrónico al <code>Cliente</code> con el contenido del mensaje. </li>
									<li>Actualiza el estado del <code>Ticket</code> a <code>esperando_cliente</code> o
										<code>cerrado</code>, según la recomendación de la IA.
									</li>
									<li>Registra un <code>LogEvento</code> de auditoría. </li>
								</ol>
							</li>
							<li>El <strong>Sistema</strong> refresca la interfaz, muestra una notificación de éxito ("Respuesta
								enviada correctamente") y retira el ticket de la cola de triaje del agente. </li>

						</ol>
					<br>$</td>
				</tr>

				<tr>
					<td align="left"> <strong>Postcondición</strong><br>$</td>
					<td align="left">
						<ol>
							<li>Se ha enviado un correo electrónico con la respuesta al cliente. </li>
							<li>Se ha guardado un nuevo <code>Mensaje</code> en el historial del ticket. </li>
							<li>El estado del <code>Ticket</code> es <code>esperando_cliente</code> o <code>cerrado</code>. </li>
							<li>El ticket ya no aparece en la cola de <code>ia_sugerido</code>. </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Excepciones (Flujos Alternativos)</strong><br>$</td>
					<td align="left">
						<ul>
							<strong>E1: Falla el servicio de envío de correos.</strong>
							<li> En el paso 5b, el proveedor externo (Mailgun) devuelve un error. </li>
							<li> El sistema anula la transacción (no se guarda el mensaje, no se cambia el estado). </li>
							<li> El sistema muestra un mensaje de error al Agente: "No se pudo enviar el correo. Por favor, intente de
								nuevo."</li>
							<li> El ticket permanece en estado <code>ia_sugerido</code>.<br><br>
								<strong>E2: El ticket fue modificado
									por otro proceso/agente.</strong>
							</li>
							<li> El Agente hace clic en "Aprobar", pero el estado del ticket en la base de datos ya no es
								<code>ia_sugerido</code>.
							</li>
							<li> El sistema detecta la inconsistencia y bloquea la acción. </li>
							<li> El sistema muestra un mensaje al Agente: "Este ticket ya ha sido actualizado. La página se
								refrescará." y actualiza la vista.
							</li>
						</ul>
						<ul>

						</ul>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Rendimiento</strong><br>$</td>
					<td align="left"> La operación completa, desde el clic del agente (paso 4) hasta la confirmación en la UI
						(paso 6), debe completarse en <strong>menos de 2 segundos</strong>.<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Frecuencia</strong><br>$</td>
					<td align="left"> Muy Alta. Se espera que sea el caso de uso más frecuente para el rol de
						<code>Agente de Triaje</code>.
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Comentarios</strong><br>$</td>
					<td align="left"> La simplicidad y velocidad de esta interacción es el principal generador de valor para la
						optimización del Nivel 1 de soporte. El diseño de la UI debe priorizar la claridad y la accesibilidad del
						botón de aprobación.<br>$</td>
				</tr>
				<tr>
					<td>$<br>$</td>
					<td>$<br>$</td>
				</tr>
				<tr>
					<td>$<br>$</td>
					<td>$<br>$</td>
				</tr>
			</tbody>
			<thead>
				<tr>
					<th align="left"><strong>ID del Caso de Uso</strong></th>
					<th align="left">UC-05</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td align="left"> <strong>Nombre</strong><br>$</td>
					<td align="left"> Editar y Enviar Respuesta Sugerida por la IA<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Actor Primario</strong><br>$</td>
					<td align="left"> Agente Especialista<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Actor Secundario(s)</strong><br>$</td>
					<td align="left"> <strong>Cliente</strong> (Recibe el mensaje), <strong>Sistema de Email (Mailgun)</strong>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Objetivos asociados</strong><br>$</td>
					<td align="left">
						<ol>
							<li><strong>Mitigación de Riesgos Operativos:</strong> Permitir la intervención humana para corregir
								errores, asegurando la calidad y precisión de toda la comunicación saliente. </li>
							<li><strong>Mejorar y Estandarizar la Experiencia del Cliente (CX):</strong> Añadir personalización o
								mejorar el tono de la respuesta generada por la IA. </li>
							<li><strong>Crear un Activo de Conocimiento Corporativo:</strong> Utilizar cada edición como un dato
								valioso para retroalimentar y mejorar el sistema de IA. </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Requisitos asociados</strong><br>$</td>
					<td align="left"> <strong>Funcionales:</strong>
						<ul>
							<li><strong>RF-AGENT-004:</strong> Un Agente de Triaje debe poder editar el texto de la
								<code>respuestaSugeridaIA</code> antes de enviarlo.
							</li>
							<li><strong>RF-AGENT-002:</strong> La UI debe presentar la sugerencia de forma clara para facilitar su
								revisión y edición. </li>
							<li><strong>RF-AGENT-003:</strong> La acción de enviar desencadena la creación de un <code>Mensaje</code>
								y el cambio de estado del ticket.<br><br><strong>Interfaces:</strong> </li>
							<li><strong>UI-02:</strong> La vista de triaje debe contener un área de texto editable para la respuesta
								de la IA. </li>

						</ul>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Descripción</strong><br>$</td>
					<td align="left"> Un Agente de Triaje revisa un ticket con una respuesta sugerida por la IA. El agente
						considera que la sugerencia es mayormente correcta pero requiere ajustes. Modifica el texto directamente en
						la interfaz de usuario y luego lo envía al cliente. El sistema registra la respuesta como un mensaje manual
						(editado) y actualiza el estado del ticket.<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Precondición</strong><br>$</td>
					<td align="left">
						<ol>
							<li>El Agente está autenticado en el sistema. </li>
							<li>Existe al menos un <code>Ticket</code> en la cola de triaje con el estado <code>ia_sugerido</code>.
							</li>
							<li>El Agente ha seleccionado y está visualizando dicho ticket en la interfaz de triaje. </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Secuencia Normal (Flujo Principal)</strong><br>$</td>
					<td align="left">
						<ol>
							<li>El <strong>Agente de Triaje</strong> selecciona un ticket de la lista en la "Vista de Triaje"
								(<code>UI-02</code>). </li>
							<li>El <strong>Sistema</strong> muestra el historial de la conversación y, en un área de texto editable
								separada, la respuesta sugerida por la IA (<code>respuestaSugeridaIA</code>). </li>
							<li>El <strong>Agente</strong> lee la sugerencia, identifica las partes que necesitan modificación y edita
								el texto directamente en el área de texto. </li>
							<li>Una vez satisfecho con los cambios, el <strong>Agente</strong> hace clic en el botón "Enviar
								Respuesta". </li>
							<li>El <strong>Sistema</strong> captura el contenido editado del área de texto. </li>
							<li>El <strong>Sistema</strong> crea un nuevo registro de <code>Mensaje</code> asociado al
								<code>Ticket</code>, guardando el texto editado y marcando que fue enviado por el agente (no simplemente
								aprobado).
							</li>
							<li>El <strong>Sistema</strong> invoca el servicio de correo (integración con Mailgun) para enviar el
								mensaje al cliente. </li>
							<li>El <strong>Sistema</strong> actualiza el estado del <code>Ticket</code> al estado post-respuesta
								configurado (ej. <code>esperando_cliente</code> o <code>cerrado</code>). </li>
							<li>El <strong>Sistema</strong> actualiza la interfaz de usuario, moviendo el mensaje enviado al historial
								de la conversación y eliminando el ticket de la cola de triaje activa. </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Postcondición</strong><br>$</td>
					<td align="left">
						<ol>
							<li>Se ha enviado un correo electrónico al cliente con el contenido modificado por el agente. </li>
							<li>Se ha creado un nuevo registro de <code>Mensaje</code> en la base de datos. </li>
							<li>El estado del <code>Ticket</code> ha sido actualizado. </li>
							<li>El <code>Ticket</code> ya no aparece en la cola de triaje del agente. </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Excepciones (Flujos Alternativos)</strong><br>$</td>
					<td align="left">
						<ul>
							<strong>E1: El ticket es actualizado mientras el agente edita.</strong>
							<li> Mientras el agente edita, el cliente envía un nuevo correo de respuesta. </li>
							<li> El sistema detecta el cambio (ej. vía SSE). Antes de que el agente pueda enviar su respuesta, el
								sistema deshabilita el botón de envío y muestra una notificación: "El cliente ha enviado un nuevo
								mensaje. La conversación ha sido actualizada." La interfaz se refresca para mostrar el nuevo mensaje del
								cliente.<br><br>
								<strong>E2: Falla el envío del correo.</strong>
							</li>
							<li> En el paso 7, la API de Mailgun devuelve un error y el correo no puede ser enviado. </li>
							<li> El sistema NO actualiza el estado del ticket y NO crea el registro del <code>Mensaje</code>. </li>
							<li> El sistema muestra una notificación de error no invasiva al agente: "Error al enviar el correo. Por
								favor, inténtalo de nuevo." El agente puede reintentar la acción.</li>
						</ul>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Rendimiento</strong><br>$</td>
					<td align="left"> La confirmación de la acción en la UI (paso 9) debe ser percibida como instantánea,
						completándose en <strong>menos de 2 segundos</strong> tras el clic del agente.<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Frecuencia</strong><br>$</td>
					<td align="left"> Media. Se espera que sea menos frecuente que <code>UC-04</code> (Aprobar) a medida que la IA
						se optimiza, pero es un flujo de trabajo esencial para el control de calidad.<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Comentarios</strong><br>$</td>
					<td align="left"> Es crucial que el sistema diferencie entre un mensaje "aprobado" y uno "editado". Esta
						distinción es fundamental para las métricas de rendimiento de la IA y para los ciclos de retroalimentación.
					<br>$</td>
				</tr>
				<tr>
					<td>$<br>$</td>
					<td>$<br>$</td>
				</tr>
				<tr>
					<td>$<br>$</td>
					<td>$<br>$</td>
				</tr>
			</tbody>
			<thead>
				<tr>
					<th align="left"><strong>ID del Caso de Uso</strong></th>
					<th align="left">UC-06</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td align="left"> <strong>Nombre</strong><br>$</td>
					<td align="left"> Escalar Ticket a Agente Especialista<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Actor Primario</strong><br>$</td>
					<td align="left"> Agente de Triaje<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Actor Secundario(s)</strong><br>$</td>
					<td align="left"> <strong>Agente Especialista</strong> (Recibe en la cola)<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Objetivos asociados</strong><br>$</td>
					<td align="left">
						<ol>
							<li><strong>Optimizar la Eficiencia Operativa:</strong> Asegurar que los tickets complejos sean manejados
								por el personal adecuado, optimizando el tiempo de todos los agentes y reduciendo el TTR. </li>
							<li><strong>Mejorar y Estandarizar la Experiencia del Cliente (CX):</strong> Prevenir la frustración del
								cliente al evitar respuestas incorrectas de un agente sin el contexto necesario. </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Requisitos asociados</strong><br>$</td>
					<td align="left"> <strong>Funcionales:</strong>
						<ul>
							<li><strong>RF-AGENT-005:</strong> Un Agente de Triaje debe poder escalar un ticket, lo que cambia su
								estado a <code>escalado_nivel_2</code>.
							</li>
							<li><strong>RF-AGENT-008:</strong> El sistema debe permitir dejar notas internas, lo cual es especialmente
								útil durante una escalada.<br><br><strong>Interfaces:</strong> </li>
							<li><strong>UI-02:</strong> La interfaz de triaje debe tener un botón o acción clara para "Escalar". </li>
							<li><strong>UI-03:</strong> La interfaz de especialista debe mostrar los tickets que han sido escalados.
							</li>

						</ul>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Descripción</strong><br>$</td>
					<td align="left"> Un Agente de Triaje revisa un ticket y determina que la consulta es demasiado compleja para
						ser resuelta en el primer nivel de soporte o que la sugerencia de la IA es completamente inadecuada. El
						agente utiliza la acción "Escalar" para mover el ticket de la cola de triaje a la cola de Agentes
						Especialistas.<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Precondición</strong><br>$</td>
					<td align="left">
						<ol>
							<li>El Agente está autenticado en el sistema. </li>
							<li>Existe al menos un <code>Ticket</code> en la cola de triaje con el estado <code>ia_sugerido</code>.
							</li>
							<li>El Agente ha seleccionado y está visualizando dicho ticket en la interfaz. </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Secuencia Normal (Flujo Principal)</strong><br>$</td>
					<td align="left">
						<ol>
							<li>El <strong>Agente de Triaje</strong> selecciona un ticket de la lista en la "Vista de Triaje". </li>
							<li>El <strong>Sistema</strong> muestra el historial del ticket y la sugerencia de la IA. </li>
							<li>El <strong>Agente</strong> evalúa el contenido y concluye que requiere conocimiento especializado (ej.
								es un problema técnico complejo, una queja sensible, etc.). </li>
							<li>El <strong>Agente</strong> hace clic en el botón "Escalar". </li>
							<li>El <strong>Sistema</strong> puede, opcionalmente, abrir una pequeña ventana modal para que el agente
								añada una nota interna para el equipo de especialistas (ej. "Cliente muy molesto, requiere revisión de
								producto dañado"). </li>
							<li>El <strong>Agente</strong> añade la nota (o la deja en blanco) y confirma la escalada. </li>
							<li>El <strong>Sistema</strong> actualiza el estado del <code>Ticket</code> a
								<code>escalado_nivel_2</code>.
							</li>
							<li>Si se añadió una nota, el <strong>Sistema</strong> la guarda como una <code>NotaInterna</code>
								asociada al ticket. </li>
							<li>El <strong>Sistema</strong> registra un evento en el log de auditoría del ticket indicando quién lo
								escaló y cuándo. </li>
							<li>El <strong>Sistema</strong> elimina el ticket de la cola de triaje del agente y lo hace visible en la
								cola de los Agentes Especialistas (<code>UI-03</code>). </li>
							<li>El <strong>Sistema</strong> refresca la interfaz del agente para mostrar el siguiente ticket en la
								cola. </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Postcondición</strong><br>$</td>
					<td align="left">
						<ol>
							<li>El estado del <code>Ticket</code> es <code>escalado_nivel_2</code>. </li>
							<li>El <code>Ticket</code> ya no es visible en la cola de triaje. </li>
							<li>El <code>Ticket</code> es ahora visible en la cola de trabajo de los Agentes Especialistas. </li>
							<li>La acción de escalada ha quedado registrada en el historial del ticket. </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Excepciones (Flujos Alternativos)</strong><br>$</td>
					<td align="left">
						<ul>
							<strong>E1: Escalada accidental.</strong>
							<li> El agente hace clic en "Escalar" por error. </li>
							<li> La inclusión de un paso de confirmación (como en el paso 6) ayuda a mitigar este riesgo. Sin una
								confirmación, el agente necesitaría buscar el ticket y revertir la acción manualmente si tiene los
								permisos, o pedir a un supervisor que lo haga.
							</li>
						</ul>
						<ul>

						</ul>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Rendimiento</strong><br>$</td>
					<td align="left"> La acción de escalar un ticket y la actualización de la UI debe ser instantánea,
						completándose en <strong>menos de 1 segundo</strong>.<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Frecuencia</strong><br>$</td>
					<td align="left"> Baja a Media. En un sistema bien afinado, el escalado manual debería ser menos común que la
						aprobación o edición. Una alta frecuencia de escalado podría indicar que la IA no está bien calibrada o que
						las reglas de escalado automático (<code>RF-IA-005</code>) son insuficientes.<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Comentarios</strong><br>$</td>
					<td align="left"> La capacidad de dejar una nota interna durante la escalada (<code>RF-AGENT-008</code>) es
						una funcionalidad de alto valor. Acelera drásticamente el trabajo del Agente Especialista, ya que le
						proporciona un resumen del análisis del Agente de Triaje.
					<br>$</td>
				</tr>
				<tr>
					<td>$<br>$</td>
					<td>$<br>$</td>
				</tr>
				<tr>
					<td>$<br>$</td>
					<td>$<br>$</td>
				</tr>
			</tbody>
			<thead>
				<tr>
					<th align="left"><strong>ID del Caso de Uso</strong></th>
					<th align="left">UC-07</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td align="left"> <strong>Nombre</strong><br>$</td>
					<td align="left"> Gestionar Etiquetas del Ticket<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Actor Primario</strong><br>$</td>
					<td align="left"> Agente Especialista<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Actor Secundario(s)</strong><br>$</td>
					<td align="left"> <strong>Agente de Triaje</strong> (Visualiza las etiquetas)<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Objetivos asociados</strong><br>$</td>
					<td align="left">
						<ol>
							<li><strong>Generar Inteligencia de Negocio:</strong> Crear metadatos estructurados que permitan generar
								informes, identificar tendencias y encontrar tickets específicos rápidamente. </li>
							<li><strong>Identificar Patrones de Falla de Producto y Servicio:</strong> Facilitar la detección de
								problemas recurrentes a través de la categorización. </li>
							<li><strong>Optimizar la Eficiencia Operativa:</strong> Ofrecer a otros agentes un contexto rápido del
								ticket sin necesidad de leer toda la conversación. </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Requisitos asociados</strong><br>$</td>
					<td align="left"> <strong>Funcionales:</strong>
						<ul>
							<li><strong>RF-AGENT-006:</strong> Implícito en la gestión de tickets de Agentes Especialistas. </li>
							<li><strong>RF-ADMIN-00 1:</strong> Depende de la gestión de usuarios y roles para asegurar que solo los
								agentes autorizados puedan realizar la acción.<br><br><strong>Interfaces:</strong> </li>
							<li><strong>UI-03:</strong> La interfaz de especialista debe incluir un componente para la gestión de
								etiquetas dentro de la vista de un ticket. </li>
						</ul>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Descripción</strong><br>$</td>
					<td align="left"> Mientras un agente revisa un ticket, puede añadir o eliminar etiquetas de una lista
						predefinida por el administrador. Esta acción actualiza los metadatos del ticket en tiempo real, mejorando
						su clasificación y visibilidad sin afectar el flujo de la conversación con el cliente.<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Precondición</strong><br>$</td>
					<td align="left">
						<ol>
							<li>El Agente está autenticado en el sistema. </li>
							<li>El Agente está visualizando la página de detalles de un ticket específico. </li>
							<li>Existe un catálogo maestro de <code>Etiqueta</code>s en el sistema, gestionado previamente por un
								<code>Administrador</code> (ver <code>UC-17</code>).
							</li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Secuencia Normal (Flujo Principal)</strong><br>$</td>
					<td align="left">
						<ol>
							<li>El <strong>Agente</strong> se encuentra en la vista de detalle de un ticket. </li>
							<li>El <strong>Agente</strong> localiza la sección de "Etiquetas" en la interfaz de usuario, que muestra
								las etiquetas actualmente asociadas. </li>
							<li>El <strong>Agente</strong> hace clic en el botón o control para "Editar Etiquetas". </li>
							<li>El <strong>Sistema</strong> presenta una interfaz interactiva (ej. un campo de búsqueda con
								autocompletado o una lista de selección múltiple) que muestra las etiquetas disponibles del catálogo
								maestro. </li>
							<li>El <strong>Agente</strong> selecciona una o más etiquetas para añadir al ticket. </li>
							<li>El <strong>Agente</strong> desmarca o elimina una o más etiquetas que ya estaban asociadas. </li>
							<li>El <strong>Agente</strong> confirma la acción (ya sea mediante un botón "Guardar" o la acción se
								ejecuta automáticamente al seleccionar/deseleccionar). </li>
							<li>El <strong>Sistema</strong> envía una solicitud al backend para actualizar las asociaciones de
								etiquetas para ese ticket. </li>
							<li>El <strong>Sistema</strong> actualiza la base de datos y refresca la sección de "Etiquetas" en la UI
								para reflejar los cambios, sin necesidad de recargar la página. </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Postcondición</strong><br>$</td>
					<td align="left">
						<ol>
							<li>La relación entre el <code>Ticket</code> y las <code>Etiqueta</code>s se ha actualizado en la base de
								datos. </li>
							<li>El cambio es inmediatamente visible en la interfaz del ticket para todos los agentes. </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Excepciones (Flujos Alternativos)</strong><br>$</td>
					<td align="left">
						<ul>
							<strong>E1: Falla la comunicación con el servidor.</strong>
							<li> En el paso 8, la solicitud para actualizar las etiquetas no llega al servidor o devuelve un error.
							</li>
							<li> El <strong>Sistema</strong> no actualiza la vista de etiquetas de forma permanente. Muestra una
								notificación de error temporal (ej. "No se pudieron guardar las etiquetas. Inténtalo de nuevo.") y
								revierte la selección en la UI al estado previo. </li>
						</ul>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Rendimiento</strong><br>$</td>
					<td align="left"> La acción de añadir o quitar una etiqueta debe reflejarse en la interfaz de usuario en
						<strong>menos de 500 milisegundos</strong>. La carga de la lista de etiquetas disponibles debe ser casi
						instantánea.
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Frecuencia</strong><br>$</td>
					<td align="left"> Alta. Se espera que los agentes ajusten las etiquetas de la mayoría de los tickets que
						gestionan para mantener una buena organización.<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Comentarios</strong><br>$</td>
					<td align="left">
						<li>Para mantener la consistencia de los datos, los agentes solo pueden seleccionar de la lista maestra. La
							creación de nuevas etiquetas es una función reservada para el <code>Administrador</code>
							(<code>UC-17</code>). </li>
						<li>La interfaz de selección de etiquetas debe ser eficiente, especialmente si el catálogo de etiquetas es
							grande (ej. con una función de búsqueda). </li>
					<br>$</td>
				</tr>
				<tr>
					<td>$<br>$</td>
					<td>$<br>$</td>
				</tr>
				<tr>
					<td>$<br>$</td>
					<td>$<br>$</td>
				</tr>
			</tbody>
			<thead>
				<tr>
					<th align="left"><strong>ID del Caso de Uso</strong></th>
					<th align="left">UC-08</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td align="left"> <strong>Nombre</strong><br>$</td>
					<td align="left"> Resolver Ticket<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Actor Primario</strong><br>$</td>
					<td align="left"> Agente Especialista<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Actor Secundario(s)</strong><br>$</td>
					<td align="left"> <strong>Cliente</strong> (Recibe el mensaje de cierre y CSAT)<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Objetivos asociados</strong><br>$</td>
					<td align="left">
						<ol>
							<li><strong>Mejorar y Estandarizar la Experiencia del Cliente (CX):</strong> Proporcionar una solución
								final y clara al problema del cliente para aumentar el CSAT. </li>
							<li><strong>Optimizar la Eficiencia Operativa:</strong> Cerrar el ciclo de soporte, actualizando el estado
								del ticket para sacarlo de las colas de trabajo activas y contribuir a la métrica de FCR. </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Requisitos asociados</strong><br>$</td>
					<td align="left"> <strong>Funcionales:</strong>
						<ul>
							<li><strong>RF-AGENT-006:</strong> Visualizar la cola de tickets asignados. </li>
							<li><strong>RF-AGENT-007:</strong> Utilizar plantillas de respuesta.
							</li>
							<li><strong>RF-AGENT-008:</strong> Dejar notas internas. </li>
							<li><strong>RF-FILE-002:</strong> Adjuntar archivos. </li>
							<li><strong>RF-TICKET-007:</strong> Enviar encuesta CSAT
								post-resolución.<br><br><strong>Interfaces:</strong> </li>
							<li><strong>UI-03:</strong> La interfaz del especialista debe proveer todas las herramientas para la
								investigación y comunicación. </li>

						</ul>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Descripción</strong><br>$</td>
					<td align="left"> Un Agente Especialista se asigna o selecciona un ticket escalado. El agente investiga el
						caso utilizando la información disponible, se comunica con el cliente a través de mensajes y, una vez que el
						problema está solucionado, realiza la acción final de cerrar el ticket, lo que actualiza su estado y puede
						desencadenar acciones posteriores como el envío de una encuesta de satisfacción.<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Precondición</strong><br>$</td>
					<td align="left">
						<ol>
							<li>El Agente está autenticado en el sistema. </li>
							<li>Existe un ticket en un estado que requiere intervención manual (ej. <code>escalado_nivel_2</code> o
								<code>esperando_agente</code>).
							</li>
							<li>El ticket está asignado al agente o se encuentra en una cola a la que el agente tiene acceso. </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Secuencia Normal (Flujo Principal)</strong><br>$</td>
					<td align="left">
						<ol>
							<li>El <strong>Agente</strong> accede a su panel de control y selecciona un ticket de su cola de trabajo.
							</li>
							<li>El <strong>Sistema</strong> carga la vista de detalle del ticket, mostrando el historial completo de
								la conversación, datos del cliente, historial de órdenes (<code>UC-09</code>), notas internas y
								cualquier otra información contextual. </li>
							<li>El <strong>Agente</strong> investiga el problema. Este es un paso manual que puede requerir consultar
								sistemas externos. </li>
							<li>El <strong>Agente</strong> redacta una respuesta para el cliente. Puede escribir un mensaje desde
								cero, insertar una <code>Plantilla</code> (<code>RF-AGENT-007</code>), o adjuntar archivos
								(<code>RF-FILE-002</code>). </li>
							<li>El <strong>Agente</strong> envía el mensaje. El <strong>Sistema</strong> lo guarda, lo envía por
								correo al cliente y actualiza el estado del ticket a <code>esperando_cliente</code>. </li>
							<li>Si el cliente responde, el ticket vuelve al estado <code>esperando_agente</code> y notifica al Agente.
								Los pasos 3-5 pueden repetirse varias veces. </li>
							<li>Una vez que el <strong>Agente</strong> considera que el problema está resuelto y ha enviado la
								comunicación final, localiza y activa la acción "Resolver Ticket". </li>
							<li>El <strong>Sistema</strong> puede presentar un diálogo de confirmación, solicitando opcionalmente una
								nota de cierre interna. </li>
							<li>El <strong>Agente</strong> confirma la acción. </li>
							<li>El <strong>Sistema</strong> actualiza el estado del ticket a <code>cerrado</code> (o
								<code>resuelto</code>).
							</li>
							<li>El <strong>Sistema</strong> ejecuta cualquier automatización post-resolución, como iniciar el envío de
								la encuesta de satisfacción (<code>RF-TICKET-007</code>). </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Postcondición</strong><br>$</td>
					<td align="left">
						<ol>
							<li>El estado del <code>Ticket</code> se actualiza a <code>cerrado</code> en la base de datos. </li>
							<li>El ticket ya no aparece en las colas de trabajo activas. </li>
							<li>Se ha preservado todo el historial de la conversación, incluyendo el mensaje final. </li>
							<li>Se ha podido iniciar un flujo de trabajo de encuesta de satisfacción. </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Excepciones (Flujos Alternativos)</strong><br>$</td>
					<td align="left">
						<ul>
							<strong>E1: El cliente reabre el ticket.</strong>
							<li> Después de que el ticket ha sido marcado como <code>cerrado</code>, el cliente responde al último
								correo. </li>
							<li> El <strong>Sistema</strong> detecta esta respuesta (<code>UC-03</code>), cambia el estado del ticket
								de <code>cerrado</code> a <code>reabierto</code> o <code>esperando_agente</code>, y lo vuelve a asignar
								al último agente que lo gestionó, notificándole la novedad.</li><br><br>
							<strong>E2: Falla el envío de un
								mensaje.</strong>
							</li>
							<li> En el paso 5, el sistema no puede enviar el correo al cliente (ej. por un fallo en la API de
								Mailgun).</li>
							<li> El <strong>Sistema</strong> no debe cambiar el estado del ticket. Debe preservar el borrador del
								mensaje del agente y mostrar un mensaje de error claro, permitiendo al agente reintentar el
								envío.<br><br>
								<strong>E3: Se requiere la intervención de otro especialista.</strong>
							</li>
							<li> Durante la investigación (paso 3), el agente determina que no es la persona adecuada para resolver el
								caso.</li>
							<li> El agente invoca el caso de uso <strong><code>UC-19: Reasignar Ticket Manualmente</code></strong>
								para transferirlo a otro colega. El caso de uso actual (<code>UC-08</code>) termina para este agente.
							</li>
						</ul>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Rendimiento</strong><br>$</td>
					<td align="left"> El envío de un mensaje y la actualización del estado del ticket deben completarse y
						confirmarse en la UI en <strong>menos de 3 segundos</strong>. Cargar la vista de un ticket con un historial
						extenso no debe superar los 4 segundos.<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Frecuencia</strong><br>$</td>
					<td align="left"> Muy Alta. Esta es la actividad principal y el ciclo de vida completo de la mayoría de los
						tickets manejados por Agentes Especialistas.<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Comentarios</strong><br>$</td>
					<td align="left">
						<li>Este caso de uso es compuesto y abarca varias interacciones más pequeñas. Su éxito depende de una
							interfaz que presente toda la información contextual de forma clara para minimizar el tiempo de
							investigación del agente. </li>
						<li>Las políticas de SLA (<code>RF-AGENT-009</code>) son cruciales aquí; la interfaz debe resaltar los
							tickets que se acercan a su vencimiento para ayudar al agente a priorizar su trabajo. </li>
					<br>$</td>
				</tr>
				<tr>
					<td>$<br>$</td>
					<td>$<br>$</td>
				</tr>
				<tr>
					<td>$<br>$</td>
					<td>$<br>$</td>
				</tr>
			</tbody>
			<thead>
				<tr>
					<th align="left"><strong>ID del Caso de Uso</strong></th>
					<th align="left">UC-09</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td align="left"> <strong>Nombre</strong><br>$</td>
					<td align="left"> Consultar Historial del Cliente<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Actor Primario</strong><br>$</td>
					<td align="left"> Agente Especialista<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Actor Secundario(s)</strong><br>$</td>
					<td align="left"> Agente triaje<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Objetivos asociados</strong><br>$</td>
					<td align="left">
						<ol>
							<li><strong>Optimizar la Eficiencia Operativa:</strong> Acelerar la resolución al centralizar toda la
								información relevante en una única vista, reduciendo el TTR. </li>
							<li><strong>Mejorar y Estandarizar la Experiencia del Cliente (CX):</strong> Permitir un servicio más
								personalizado y proactivo, demostrando que se conoce el historial del cliente. </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Requisitos asociados</strong><br>$</td>
					<td align="left"> <strong>Funcionales:</strong>
						<ul>
							<li><strong>RF-AGENT-009:</strong> (Implícito) La capacidad de consultar el historial es un prerrequisito
								para un flujo de trabajo de agente eficiente.
							</li>
							<li><strong>RF-DATA-00 1:</strong> Depende de que los datos de <code>Orden</code> hayan sido importados
								previamente.<br><br><strong>Interfaces:</strong> </li>
							<li><strong>UI-02 / UI-03:</strong> La vista del historial es un componente fundamental de la interfaz de
								gestión de tickets. </li>

						</ul>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Descripción</strong><br>$</td>
					<td align="left"> Mientras un Agente trabaja en un ticket activo, necesita comprender el historial completo
						del cliente para ofrecer una solución informada. El Agente accede a una vista unificada que consolida tanto
						el historial de tickets de soporte previos (abiertos y cerrados) como el historial de órdenes de compra del
						cliente.<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Precondición</strong><br>$</td>
					<td align="left">
						<ol>
							<li>El Agente está autenticado en el sistema. </li>
							<li>El Agente tiene asignado o ha abierto un <code>Ticket</code> de un <code>Cliente</code> específico.
							</li>
							<li>Los datos de las <code>Orden</code>es del cliente han sido previamente importados y están disponibles
								en la base de datos de NoraAI. </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Secuencia Normal (Flujo Principal)</strong><br>$</td>
					<td align="left">
						<ol>
							<li>El <strong>Agente</strong> está en la vista de detalle de un ticket activo. </li>
							<li>El <strong>Agente</strong> hace clic en el nombre del cliente o en un botón/enlace específico como
								"Ver Historial del Cliente". </li>
							<li>El <strong>Sistema</strong> recupera de la base de datos toda la información asociada al
								<code>id</code> del cliente del ticket actual, incluyendo: <ol type="a">
									<li>Todos los demás <code>Ticket</code>s asociados a ese cliente. </li>
									<li>Todas las <code>Orden</code>es asociadas a ese cliente. </li>
								</ol>
							</li>
							<li>El <strong>Sistema</strong> presenta una "Vista de Perfil de Cliente" unificada, organizada y
								fácil de consultar. Esta vista contiene como mínimo dos secciones principales: <ol type="a">

									<li><strong>Sección de Historial de Soporte:</strong> Una lista cronológica inversa (del más
										reciente
										al más antiguo) de todos los tickets del cliente. Cada elemento de la lista muestra información
										clave de un vistazo: ID del Ticket, Asunto, Fecha de Creación y Estado Actual
										(<code>abierto</code>,
										<code>cerrado</code>, <code>escalado</code>, etc.).
									</li>
									<li><strong>Sección de Historial de Órdenes:</strong> Una lista cronológica inversa de todas las
										órdenes del cliente. Cada elemento muestra: ID de la Orden, Fecha de Compra, Estado de la Orden
										(<code>enviado</code>, <code>entregado</code>, <code>devuelto</code>) y el Monto Total. </li>
								</ol>
							</li>
							<li>El <strong>Agente</strong> puede interactuar con esta vista para obtener más detalles: <ol type="a">

									<li>Al hacer clic en un ticket del historial, el <strong>Sistema</strong> podría mostrar un
										resumen o
										abrir el historial completo de esa conversación en un modal o panel lateral. </li>
									<li>Al hacer clic en una orden, el <strong>Sistema</strong> muestra los detalles completos de
										la
										misma, incluyendo los productos comprados y la dirección de envío. </li>
								</ol>
							</li>
							<li>El <strong>Agente</strong> utiliza la información obtenida para formular una respuesta más
								precisa
								y contextualizada en el ticket activo. </li>


						</ol>
					<br>$</td>
				</tr>

				<tr>
					<td align="left"> <strong>Postcondición</strong><br>$</td>
					<td align="left">
						<ol>
							<li>El Agente ha obtenido el contexto necesario sobre el cliente. </li>
							<li>El estado del ticket activo y del sistema no ha cambiado (es una operación de solo lectura). </li>
							<li>El Agente regresa a la vista del ticket activo para continuar con su trabajo. </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Excepciones (Flujos Alternativos)</strong><br>$</td>
					<td align="left">
						<ul>
							<strong>E1: Cliente sin historial previo.</strong>
							<li> En el paso 3, el sistema no encuentra tickets ni órdenes previas para este cliente. </li>
							<li> En el paso 4, la Vista de Perfil de Cliente muestra mensajes claros en cada sección, como "Este es el
								primer ticket de este cliente" y "No se encontraron órdenes para este cliente".<br><br>
								<strong>E2: Los
									datos de órdenes no están actualizados.</strong>
							</li>
							<li> El cliente menciona una orden reciente que no aparece en el historial.<br>
							</li>
							<li>La interfaz podría mostrar una marca de tiempo como "Datos de órdenes actualizados por última vez el
								[fecha/hora]" para que el agente sea consciente de la posible obsolescencia de los datos. El Agente debe
								proceder sabiendo que la información puede no ser completa.
							</li>
						</ul>

						<ul>

						</ul>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Rendimiento</strong><br>$</td>
					<td align="left"> La carga de la Vista de Perfil de Cliente (paso 4) debe completarse en <strong>menos de 2
							segundos</strong> para un cliente con un historial considerable (ej. 50 tickets y 100 órdenes).<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Frecuencia</strong><br>$</td>
					<td align="left"> Alta. Se espera que los agentes consulten el historial en la mayoría de los tickets que no
						sean triviales.<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Comentarios</strong><br>$</td>
					<td align="left">
						<li>El diseño de la "Vista de Perfil de Cliente" es crucial para la usabilidad. Debe priorizar la
							información más relevante y permitir una fácil navegación entre el historial y el ticket activo.
						</li>
						<li>Esta
							funcionalidad es uno de los mayores diferenciadores de valor para el agente, ya que combate directamente
							la frustración de recibir tickets sin contexto.
						</li>
					<br>$</td>

				</tr>
				<tr>
					<td>$<br>$</td>
					<td>$<br>$</td>
				</tr>
				<tr>
					<td>$<br>$</td>
					<td>$<br>$</td>
				</tr>
			</tbody>
			<thead>
				<tr>
					<th align="left"><strong>ID del Caso de Uso</strong></th>
					<th align="left">UC-10</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td align="left"> <strong>Nombre</strong><br>$</td>
					<td align="left"> Adjuntar y Descargar Archivos<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Actor Primario</strong><br>$</td>
					<td align="left"> Agente Especialista (Descargar y Adjuntar), Cliente (Adjuntar vía email)<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Actor Secundario(s)</strong><br>$</td>
					<td align="left"> <strong>Supabase Storage</strong><br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Objetivos asociados</strong><br>$</td>
					<td align="left">
						<ol>
							<li><strong>Optimizar la Eficiencia Operativa:</strong> Facilitar el intercambio de evidencia crucial
								(fotos, facturas) para acelerar el diagnóstico y la resolución. </li>
							<li><strong>Mitigación de Riesgos Operativos:</strong> Asegurar que todos los artefactos de un caso se
								almacenen de forma centralizada, completa y segura. </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Requisitos asociados</strong><br>$</td>
					<td align="left"> <strong>Funcionales:</strong>
						<ul>
							<li><strong>RF-FILE-00 1:</strong> El sistema debe procesar archivos adjuntos de correos entrantes. </li>
							<li><strong>RF-FILE-002:</strong> Los adjuntos deben almacenarse de forma segura en Supabase Storage.
							</li>
							<li><strong>RF-IA-005:</strong> (Relacionado) La presencia de un adjunto de imagen puede ser una condición
								para la escalada automática.<br><br><strong>Interfaces:</strong>
							</li>
							<li><strong>API-05:</strong> El sistema debe usar la API de Supabase Storage. </li>

						</ul>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Descripción</strong><br>$</td>
					<td align="left"> Este caso de uso cubre el ciclo de vida completo de los archivos adjuntos. Describe cómo un
						agente puede visualizar y descargar archivos enviados por un cliente, y cómo puede adjuntar sus propios
						archivos al enviar una respuesta.<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Precondición</strong><br>$</td>
					<td align="left">
						<ol>
							<li>El Agente está autenticado en el sistema y tiene un ticket abierto. </li>
							<li>Para descargar: El ticket contiene al menos un archivo adjunto enviado previamente por el cliente.
							</li>
							<li>Para adjuntar: El Agente está redactando una respuesta para el cliente. </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Secuencia Normal (Flujo Principal)</strong><br>$</td>
					<td align="left">
						<ul>
							<strong>Flujo A: Agente Visualiza y Descarga un Archivo del Cliente</strong>
							<li>El <strong>Sistema</strong>, a través del proceso <code>UC-02</code>, ha recibido un email de un
								cliente con uno o más archivos adjuntos. </li>
							<li>En la vista de detalle del ticket, el <strong>Sistema</strong> muestra los mensajes de la
								conversación. En el mensaje del cliente que contenía los adjuntos, se muestran representaciones visuales
								de los mismos (ej. un icono de archivo, el nombre del archivo, su tamaño y una miniatura si es una
								imagen). </li>
							<li>El <strong>Agente</strong> hace clic en el nombre o la miniatura del archivo que desea ver. </li>
							<li>El <strong>Sistema</strong> genera una URL de acceso segura y temporal desde Supabase Storage
								(<code>API-05</code>). </li>
							<li>El navegador del <strong>Agente</strong> abre una nueva pestaña para mostrar el archivo (si es un
								formato soportado como PDF o imagen) o inicia directamente el proceso de descarga estándar del
								navegador.<br><br><strong>Flujo B: Agente Adjunta un Archivo a una Respuesta</strong> </li>
							<li>Mientras redacta una respuesta en la interfaz del ticket, el <strong>Agente</strong> hace clic en el
								botón "Adjuntar Archivo" (o arrastra y suelta un archivo en el área de respuesta). </li>
							<li>El <strong>Sistema</strong> abre el selector de archivos del sistema operativo del Agente. </li>
							<li>El <strong>Agente</strong> selecciona uno o más archivos para adjuntar. </li>
							<li>El <strong>Sistema</strong> valida los archivos seleccionados en el frontend (tamaño máximo, tipo de
								archivo permitido). </li>
							<li>Una vez validados, el <strong>Sistema</strong> sube los archivos de forma segura a Supabase Storage
								(<code>API-05</code>). Mientras se suben, la UI muestra un indicador de progreso. </li>
							<li>Una vez completada la subida, el <strong>Sistema</strong> recibe las URLs de los archivos almacenados.
								La UI muestra los archivos adjuntados debajo del área de texto de la respuesta. </li>
							<li>El <strong>Agente</strong> termina de redactar su mensaje y hace clic en "Enviar". </li>
							<li>El <strong>Sistema</strong> crea el registro del <code>Mensaje</code> en la base de datos, lo asocia
								con los registros de los <code>Archivo</code>s recién subidos y envía el correo al cliente a través de
								Mailgun, incluyendo los archivos como adjuntos de correo estándar. </li>
						</ul>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Postcondición</strong><br>$</td>
					<td align="left">
						<ul>
							<strong>Flujo A (Descargar):</strong>
							<li>El Agente tiene una copia local del archivo del cliente. El estado del sistema no
								cambia.<br><br><strong>Flujo B (Adjuntar):</strong> </li>
							<li>Se han creado uno o más registros en la tabla <code>Archivo</code>. </li>
							<li>Los archivos físicos están almacenados en Supabase Storage. </li>
							<li>Se ha enviado un correo al cliente con los archivos adjuntos. </li>
						</ul>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Excepciones (Flujos Alternativos)</strong><br>$</td>
					<td align="left">
						<ul>
							<strong>E1: El tipo de archivo no está permitido.</strong>
							<li> En el Flujo B, paso 4, el Agente intenta subir un archivo con una extensión no permitida (ej.
								<code>.exe</code>).
							</li>
							<li> La UI muestra un mensaje de error inmediato: "Tipo de archivo no permitido. Solo se aceptan [lista de
								tipos]". La subida se cancela.<br><br>
								<strong>E2: El archivo excede el tamaño máximo.</strong>
							</li>
							<li> En el Flujo B, paso 4, el Agente intenta subir un archivo más grande que el límite configurado (ej.
								10 MB).</li>
							<li> La UI muestra un mensaje de error: "El archivo es demasiado grande. El tamaño máximo es de 10 MB." La
								subida se cancela.<br><br>
								<strong>E3: Falla la subida del archivo.</strong>
							</li>
							<li> En el Flujo B, paso 5, ocurre un error de red o un problema con el servicio de almacenamiento. </li>
							<li> La UI muestra un mensaje de error claro junto al archivo que falló, con una opción para reintentar la
								subida.<br><br>
								<strong>E4: Se detecta un virus en el archivo (Requisito de Seguridad
									Implícito).</strong>
							</li>
							<li> Durante la subida (Flujo B, paso 5) o al procesar un adjunto entrante (Flujo A, paso 1), un escáner
								de virus integrado detecta que el archivo es malicioso.</li>
							<li> El <strong>Sistema</strong> rechaza el archivo, lo pone en cuarentena o lo elimina. Se registra un
								evento de seguridad. La UI informa al Agente que el archivo fue bloqueado por razones de seguridad.
							</li>
						</ul>
						<ul>

						</ul>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Seguridad</strong><br>$</td>
					<td align="left">
						<li><strong>Control de Acceso:</strong> Las URLs de los archivos en Supabase Storage deben ser firmadas y de
							corta duración para prevenir el acceso no autorizado. </li>
						<li><strong>Validación de Tipos:</strong> Se debe mantener una lista blanca estricta de tipos de archivo
							permitidos (MIME types), tanto en el frontend como en el backend. </li>
						<li><strong>Escaneo de Malware:</strong> Es altamente recomendable integrar un servicio de escaneo de virus
							para todos los archivos subidos. </li>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Frecuencia</strong><br>$</td>
					<td align="left"> Media. Es una función esencial, pero no se utiliza en todos los tickets.<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Comentarios</strong><br>$</td>
					<td align="left">
						<li>La experiencia de usuario para la subida de archivos debe ser fluida, implementando "arrastrar y soltar"
							(drag-and-drop) y mostrando indicadores de progreso claros. </li>
						<li>Este caso de uso impacta directamente la lógica de negocio (<code>RF-IA-005</code>), ya que la detección
							de imágenes es un disparador para la escalada automática. El sistema debe tratar el procesamiento de
							adjuntos como un evento significativo. </li>
						<li>Parámetros como el <strong>tamaño máximo por archivo</strong> y la <strong>lista blanca de tipos MIME
								permitidos</strong> deben ser variables de configuración del sistema, no valores codificados
							(<code>hardcoded</code>), para facilitar su mantenimiento. </li>
						<li>Se debe definir una política de retención de datos para los archivos almacenados, considerando costos de
							almacenamiento a largo plazo y normativas de privacidad. </li>
					<br>$</td>
				</tr>
				<tr>
					<td>$<br>$</td>
					<td>$<br>$</td>
				</tr>
				<tr>
					<td>$<br>$</td>
					<td>$<br>$</td>
				</tr>
			</tbody>
			<thead>
				<tr>
					<th align="left"><strong>ID del Caso de Uso</strong></th>
					<th align="left">UC-11</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td align="left"> <strong>Nombre</strong><br>$</td>
					<td align="left"> Añadir Nota Interna al Ticket<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Actor Primario</strong><br>$</td>
					<td align="left"> Agente Especialista<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Actor Secundario(s)</strong><br>$</td>
					<td align="left"> <strong>Agente de Triaje</strong> (Visualiza la nota)<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Objetivos asociados</strong><br>$</td>
					<td align="left">
						<ol>
							<li><strong>Optimizar la Eficiencia Operativa:</strong> Permitir que los agentes colaboren y compartan
								contexto crítico sobre un caso sin exponerlo al cliente, agilizando las transferencias o escalados.
							</li>
							<li><strong>Mitigación de Riesgos Operativos:</strong> Mantener un historial interno completo de
								decisiones y observaciones para futura referencia y auditoría. </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Requisitos asociados</strong><br>$</td>
					<td align="left"> <strong>Funcionales:</strong>
						<ul>
							<li><strong>RF-AGENT-008:</strong> El sistema deberá permitir a los agentes dejar notas internas y
								@mencionar a otros agentes. </li>
							<li><strong>RF-ADMIN-005:</strong> Las notas deben ser visibles en el historial completo revisado por
								supervisores. </li>
						</ul>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Descripción</strong><br>$</td>
					<td align="left"> Un agente añade un comentario privado a un ticket. Este comentario es estrictamente para uso
						interno y nunca es visible para el cliente final. Puede incluir texto enriquecido y menciones a otros
						usuarios del sistema para solicitar su ayuda o informarles.<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Precondición</strong><br>$</td>
					<td align="left">
						<ol>
							<li>El Agente ha iniciado sesión y tiene permisos de acceso al ticket en cuestión. </li>
							<li>El Agente se encuentra visualizando la vista detallada del ticket. </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Secuencia Normal (Flujo Principal)</strong><br>$</td>
					<td align="left">
						<ol>
							<li>El <strong>Agente</strong> selecciona la opción "Añadir Nota Interna" en la interfaz del ticket
								(diferenciada claramente de la opción "Responder al Cliente"). </li>
							<li>El <strong>Sistema</strong> muestra un área de texto dedicada para la nota, con un indicador visual
								claro (ej. fondo amarillo o icono de candado) de que es contenido privado. </li>
							<li>El <strong>Agente</strong> redacta el contenido de la nota.<br> * <em>(Opcional)</em> El agente
								escribe "@" seguido del nombre de otro agente. El sistema sugiere usuarios y el agente selecciona uno
								para mencionarlo. </li>
							<li>El <strong>Agente</strong> confirma la acción haciendo clic en "Guardar Nota". </li>
							<li>El <strong>Sistema</strong> valida el contenido (no vacío) y lo guarda en la base de datos asociado al
								ticket y al agente autor. </li>
							<li>El <strong>Sistema</strong> actualiza la línea de tiempo del ticket en tiempo real, mostrando la nueva
								nota con un estilo visual distintivo que la diferencia de los mensajes públicos. </li>
							<li><em>(Si hubo menciones)</em> El <strong>Sistema</strong> envía una notificación interna (in-app o
								email, según configuración) al agente mencionado. </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Postcondición</strong><br>$</td>
					<td align="left">
						<ol>
							<li>La nota interna queda registrada permanentemente en el historial del ticket. </li>
							<li>La nota es visible solo para usuarios con rol de Agente o superior. </li>
							<li>Los usuarios mencionados han recibido una notificación. </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Excepciones (Flujos Alternativos)</strong><br>$</td>
					<td align="left">
						<ul>
							<strong>E1: Intento de guardar una nota vacía.</strong>
							<li> El Agente intenta guardar sin haber escrito texto. </li>
							<li> El Sistema deshabilita el botón de guardar o muestra un mensaje de error indicando que el contenido
								es requerido.<br><br>
								<strong>E2: Falla al guardar la nota.</strong>
							</li>
							<li> Ocurre un error de red o servidor al intentar persistir la nota. </li>
							<li> El Sistema muestra un mensaje de error ("No se pudo guardar la nota. Reintentando..") y permite al
								agente intentar de nuevo sin perder el texto escrito.
							</li>
						</ul>
						<ul>

						</ul>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Frecuencia</strong><br>$</td>
					<td align="left"> Alta. Utilizado frecuentemente en tickets complejos (<code>escalado_nivel_2</code>) o que
						requieren seguimiento a largo plazo.<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Comentarios</strong><br>$</td>
					<td align="left">
						<li>Es crítico que la UI diferencie inequívocamente entre "Nota Interna" y "Respuesta Pública" para evitar
							que información sensible sea enviada accidentalmente al cliente. </li>
						<li>Las notas internas no deberían cambiar el estado del ticket (ej. de <code>cerrado</code> a
							<code>abierto</code>) a menos que se configure específicamente una regla para ello.
						</li>
					<br>$</td>
				</tr>
				<tr>
					<td>$<br>$</td>
					<td>$<br>$</td>
				</tr>
				<tr>
					<td>$<br>$</td>
					<td>$<br>$</td>
				</tr>
			</tbody>
			<thead>
				<tr>
					<th align="left"><strong>ID del Caso de Uso</strong></th>
					<th align="left">UC-12</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td align="left"> <strong>Nombre</strong><br>$</td>
					<td align="left"> Gestionar Configuración de Agente IA<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Actor Primario</strong><br>$</td>
					<td align="left"> Administrador<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Actor Secundario(s)</strong><br>$</td>
					<td align="left"> <strong>Proveedor LLM (OpenRouter)</strong>, <strong>Agente de Triaje</strong> (Afectado por
						los cambios)<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Objetivos asociados</strong><br>$</td>
					<td align="left">
						<ol>
							<li><strong>Optimizar la Eficiencia Operativa:</strong> Ajustar los prompts y parámetros del LLM para
								mejorar la precisión y balancear el costo y la calidad de las respuestas. </li>
							<li><strong>Mejorar y Estandarizar la Experiencia del Cliente (CX):</strong> Refinar el tono y la
								adherencia a las políticas de la empresa en las respuestas sugeridas. </li>
							<li><strong>Mitigación de Riesgos Operativos:</strong> Controlar el comportamiento de la IA y definir los
								umbrales de confianza para acciones automáticas. </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Requisitos asociados</strong><br>$</td>
					<td align="left"> <strong>Funcionales:</strong>
						<ul>
							<li><strong>RF-ADMIN-002:</strong> Un administrador debe poder gestionar y auditar cambios en
								<code>ConfigAgente</code>.
							</li>
							<li><strong>RF-IA-002:</strong> El sistema debe usar estas configuraciones para generar las propuestas.
							</li>
						</ul>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Descripción</strong><br>$</td>
					<td align="left"> El Administrador crea, lee, actualiza o elimina (CRUD) registros de la entidad
						<code>ConfigAgente</code>. Estos registros actúan como "perfiles" que definen cómo se comporta la IA ante
						diferentes tipos de tickets (ej. un perfil para "Devoluciones", otro para "Envíos").
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Precondición</strong><br>$</td>
					<td align="left">
						<ol>
							<li>El Administrador ha iniciado sesión con una cuenta que posee privilegios de superusuario. </li>
							<li>Existe al menos un proveedor de LLM configurado en el sistema. </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Secuencia Normal (Flujo Principal)</strong><br>$</td>
					<td align="left">
						<ol>
							<li>El <strong>Administrador</strong> navega a la sección de "Configuración de IA" en el panel de
								administración. </li>
							<li>El <strong>Sistema</strong> muestra una lista de las configuraciones existentes (ej. "Agente General",
								"Especialista en RMA", "Detector de Spam"). </li>
							<li>El <strong>Administrador</strong> selecciona una configuración para editar o hace clic en "Crear Nueva
								Configuración". </li>
							<li>El <strong>Sistema</strong> presenta el formulario de edición con los siguientes campos clave:
								<ol type="a">
									<li>
										<code>Nombre/Tipo</code>: Identificador del perfil (ej. "wismo_agent").
									</li>
									<li>
										<code>Prompt del Sistema</code>: El texto base que instruye al LLM sobre su rol y reglas.
									</li>
									<li>
										<code>Modelo</code>: Selector del modelo LLM a usar (ej. GPT-4o, Claude 3.5 Sonnet).
									</li>
									<li>
										<code>Temperatura</code>: Valor numérico (0.0-1.0) para controlar la creatividad.
									</li>
									<li>
										<code>Umbral de Confianza</code>: Valor mínimo (0.0-1.0) para considerar una sugerencia como válida.
									</li>
								</ol>
							</li>
							<li>El <strong>Administrador</strong> modifica los parámetros deseados. </li>
							<li>El <strong>Administrador</strong> guarda los cambios. </li>
							<li>El <strong>Sistema</strong> valida que los valores numéricos estén en rangos permitidos y que el
								prompt no esté vacío. </li>
							<li>El <strong>Sistema</strong> guarda la nueva versión de la configuración y registra el evento en el log
								de auditoría para trazabilidad. </li>
						</ol>


					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Postcondición</strong><br>$</td>
					<td align="left">
						<ol>
							<li>La configuración es actualizada en la base de datos. </li>
							<li>Todos los <em>nuevos</em> tickets procesados a partir de este momento utilizarán los parámetros
								actualizados. </li>
							<li>Se genera un registro de auditoría indicando quién hizo el cambio y cuándo. </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Excepciones (Flujos Alternativos)</strong><br>$</td>
					<td align="left">
						<ul>
							<strong>E1: Validación de parámetros fallida.</strong>
							<li> El Administrador introduce una temperatura fuera de rango (ej.
							</li>
							<li>5) o deja el prompt en blanco. </li>
							<li> El Sistema impide guardar y muestra un error específico junto al campo inválido.<br><br>
								<strong>E2:
									Eliminación de una configuración en uso.</strong>
							</li>
							<li> El Administrador intenta borrar una configuración que es la predeterminada del sistema. </li>
							<li> El Sistema bloquea la eliminación y muestra una advertencia: "No se puede eliminar la configuración
								activa predeterminada. Asigne otra como predeterminada primero."</li>
						</ul>
						<ul>

						</ul>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Frecuencia</strong><br>$</td>
					<td align="left"> Baja. Se realiza esporádicamente cuando se detecta la necesidad de mejorar el rendimiento de
						la IA o cambian las políticas de negocio.<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Comentarios</strong><br>$</td>
					<td align="left">
						<li>Los cambios en estos prompts tienen un alto impacto en la operación. Se recomienda (para versiones
							futuras) implementar un sistema de "versiones de prompt" y un entorno de "sandbox" para probar los cambios
							antes de aplicarlos a producción. </li>
						<li>Es vital guardar un historial de cambios (quién cambió qué y cuándo) para poder revertir rápidamente si
							una nueva configuración causa problemas graves en las respuestas automáticas. </li>
					<br>$</td>
				</tr>
				<tr>
					<td>$<br>$</td>
					<td>$<br>$</td>
				</tr>
				<tr>
					<td>$<br>$</td>
					<td>$<br>$</td>
				</tr>
			</tbody>
			<thead>
				<tr>
					<th align="left"><strong>ID del Caso de Uso</strong></th>
					<th align="left">UC-13</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td align="left"> <strong>Nombre</strong><br>$</td>
					<td align="left"> Gestionar Plantillas de Respuesta<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Actor Primario</strong><br>$</td>
					<td align="left"> Administrador<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Actor Secundario(s)</strong><br>$</td>
					<td align="left"> <strong>Agente Especialista/Triaje</strong> (Utiliza las plantillas)<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Objetivos asociados</strong><br>$</td>
					<td align="left">
						<ol>
							<li><strong>Mejorar y Estandarizar la Experiencia del Cliente (CX):</strong> Asegurar que las respuestas
								para consultas comunes sean consistentes en tono, formato y precisión. </li>
							<li><strong>Optimizar la Eficiencia Operativa:</strong> Acelerar los tiempos de respuesta al proveer a los
								agentes respuestas pre-aprobadas. </li>
							<li><strong>Acelerar la Formación de Nuevos Agentes (Onboarding):</strong> Permitir que los nuevos agentes
								se apoyen en plantillas validadas mientras aprenden los procedimientos. </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Requisitos asociados</strong><br>$</td>
					<td align="left"> <strong>Funcionales:</strong>
						<ul>
							<li><strong>RF-AGENT-007:</strong> El sistema debe permitir a los agentes utilizar y gestionar plantillas
								de respuesta. (Este UC se enfoca en la parte de "gestionar", que es una función administrativa para
								mantener el control de calidad).<br><br><strong>No Funcionales:</strong> </li>
							<li><strong>NFR-USAB-00 1 (implícito):</strong> La interfaz para crear y editar plantillas debe ser
								intuitiva y fácil de usar para un rol administrativo. </li>
						</ul>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Descripción</strong><br>$</td>
					<td align="left"> El Administrador del sistema accede a una interfaz de configuración para realizar
						operaciones de creación, lectura, actualización y eliminación (CRUD) sobre el catálogo de plantillas de
						respuesta. Estas plantillas son fragmentos de texto reutilizables que los agentes pueden invocar y
						personalizar al responder a un ticket. El sistema debe soportar el uso de variables dinámicas (placeholders)
						para personalizar automáticamente las plantillas con datos del ticket o del cliente.<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Precondición</strong><br>$</td>
					<td align="left">
						<ol>
							<li>El usuario está autenticado en el sistema y posee el rol de <code>Administrador</code>. </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Secuencia Normal (Flujo Principal)</strong><br>$</td>
					<td align="left">
						<ol>
							<li>El <strong>Administrador</strong> navega a la sección "Configuración" &gt; "Plantillas" de la
								aplicación. </li>
							<li>El <strong>Sistema</strong> muestra una lista de todas las plantillas existentes, mostrando su
								nombre/título y un extracto del contenido. </li>
							<li>El <strong>Administrador</strong> inicia una de las siguientes acciones:<br> <strong>
								</strong>
								<ol type="a"><strong>
									</strong>
									<li><strong>Para Crear una nueva plantilla:
										</strong></li>
									<ol type="i">
										<li>Hace clic en el botón "Nueva Plantilla". </li>
										<li>El <strong>Sistema</strong> presenta un formulario con los campos: <code>Nombre</code> (un
											identificador corto y descriptivo), <code>Contenido</code> (un editor de texto enriquecido o
											simple),
											y una lista de <code>Variables Disponibles</code> (ej. <code>{{cliente.nombre}}</code>,
											<code>{{ticket.id}}</code>, <code>{{agente.nombre}}</code>).
										</li>
										<li>El <strong>Administrador</strong> completa el nombre y redacta el contenido, insertando las
											variables necesarias. </li>
										<li>El <strong>Administrador</strong> guarda la plantilla. </li>
										<li>El <strong>Sistema</strong> valida que el nombre y el contenido no estén vacíos, guarda la nueva
											plantilla en la base de datos y actualiza la lista.<br> <strong></strong></li><strong>
										</strong>
									</ol><strong>
									</strong>
									<li><strong>Para Modificar una plantilla existente:</strong></li>
									<ol type="i">
										<li>Busca la plantilla en la lista y hace clic en el botón "Editar". </li>
										<li>El <strong>Sistema</strong> carga los datos de la plantilla en el mismo formulario de creación.
										</li>
										<li>El <strong>Administrador</strong> realiza los cambios necesarios y guarda. </li>
										<li>El <strong>Sistema</strong> valida y actualiza el registro en la base de datos.<br>
										</li>
									</ol>


									<li><strong>Para Eliminar una plantilla:</strong></li>
									<ol type="i">
										<li>Busca la plantilla en la lista y hace clic en el botón "Eliminar". </li>
										<li>El <strong>Sistema</strong> muestra un cuadro de diálogo de confirmación para prevenir la
											eliminación
											accidental. </li>
										<li>El <strong>Administrador</strong> confirma la acción. </li>
										<li>El <strong>Sistema</strong> elimina el registro de la base de datos y actualiza la lista. </li>
									</ol>
								</ol>
							</li>
						</ol>
					<br>$</td>
				</tr>



				<tr>
					<td align="left"> <strong>Postcondición</strong><br>$</td>
					<td align="left">
						<ol>
							<li>El catálogo de plantillas disponible para los agentes está actualizado (creado, modificado o
								eliminado) y los cambios se reflejan de inmediato para su uso en la resolución de tickets.</li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Excepciones (Flujos Alternativos)</strong><br>$</td>
					<td align="left">
						<ul>
							<strong>E1: Falla la validación de datos.</strong>
							<li> En los pasos 3.a.v o 3.b.iv, el Administrador intenta guardar una plantilla con el campo
								<code>Nombre</code> o <code>Contenido</code> vacío.
							</li>
							<li> El <strong>Sistema</strong> no guarda los cambios, muestra un mensaje de error descriptivo junto al
								campo correspondiente y mantiene al usuario en el formulario de edición.<br><br>
								<strong>E2: Intento de
									crear una plantilla con un nombre duplicado.</strong>
							</li>
							<li> El <strong>Sistema</strong> detecta que el <code>Nombre</code> ya existe, rechaza la operación y
								muestra un error: "Ya existe una plantilla con este nombre." </li>
						</ul>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Rendimiento</strong><br>$</td>
					<td align="left"> La carga de la lista de plantillas y las operaciones CRUD deben completarse en menos de 2
						segundos.<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Frecuencia</strong><br>$</td>
					<td align="left"> Baja. Se realiza principalmente durante la configuración inicial del sistema o cuando las
						políticas de la empresa cambian.<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Comentarios</strong><br>$</td>
					<td align="left">
						<li>La funcionalidad de variables (placeholders) es la clave de este caso de uso. Sin ella, la utilidad de
							las plantillas es muy limitada. El sistema debe tener una lógica robusta para buscar y reemplazar estas
							variables con los datos correctos en el momento en que un agente utiliza la plantilla.
						</li>
					<br>$</td>

				</tr>
				<tr>
					<td>$<br>$</td>
					<td>$<br>$</td>
				</tr>
				<tr>
					<td>$<br>$</td>
					<td>$<br>$</td>
				</tr>
			</tbody>
			<thead>
				<tr>
					<th align="left"><strong>ID del Caso de Uso</strong></th>
					<th align="left">UC-14</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td align="left"> <strong>Nombre</strong><br>$</td>
					<td align="left"> Gestionar Base de Conocimiento para IA<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Actor Primario</strong><br>$</td>
					<td align="left"> Administrador<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Actor Secundario(s)</strong><br>$</td>
					<td align="left"> <strong>Proveedor LLM (OpenRouter)</strong><br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Objetivos asociados</strong><br>$</td>
					<td align="left">
						<ol>
							<li><strong>Crear un Activo de Conocimiento Corporativo:</strong> Centralizar y estructurar el
								conocimiento de la empresa en un repositorio único y gestionado. </li>
							<li><strong>Mitigación de Riesgos Operativos:</strong> Proveer al LLM una fuente de verdad para reducir
								alucinaciones y basar sus respuestas en políticas verificadas. </li>
							<li><strong>Escalar las Operaciones de Soporte:</strong> Permitir que el sistema se mantenga actualizado
								de forma rápida ante cambios del negocio (nuevos productos, políticas, etc.). </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Requisitos asociados</strong><br>$</td>
					<td align="left"> <strong>Funcionales:</strong>
						<ul>
							<li><strong>RF-IA-002:</strong> El sistema deberá utilizar configuraciones de agente especializadas.. para
								construir el prompt. (La Base de Conocimiento es el componente principal para la técnica de RAG-
								Retrieval-Augmented Generation, que es la implementación de esta especialización). </li>
							<li><strong>RF-ADMIN-002 (implícito):</strong> La gestión de la Base de Conocimiento es una forma de
								configurar el comportamiento del agente de IA. </li>
						</ul>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Descripción</strong><br>$</td>
					<td align="left"> El Administrador gestiona el ciclo de vida de los artículos en la Base de Conocimiento. Esta
						no es una base de conocimiento para que la lean los humanos, sino el corpus de texto que se procesará para
						ser utilizado por el LLM. Cada vez que se crea o actualiza un artículo, el sistema debe iniciar un proceso
						asíncrono en segundo plano para "vectorizar" el contenido: lo divide en fragmentos (chunks), genera una
						representación numérica (embedding) para cada fragmento y lo almacena en una base de datos vectorial. Este
						índice vectorial es lo que el sistema usará para encontrar la información más relevante para un nuevo
						ticket.<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Precondición</strong><br>$</td>
					<td align="left">
						<ol>
							<li>El usuario está autenticado en el sistema y posee el rol de <code>Administrador</code>. </li>
							<li>La infraestructura de base de datos vectorial (ej. la extensión <code>pgvector</code> en PostgreSQL)
								está instalada y configurada. </li>
							<li>La integración con un servicio de generación de embeddings (ej. a través de OpenRouter o directamente
								con un proveedor como OpenAI) está configurada.</li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Secuencia Normal (Flujo Principal)</strong><br>$</td>
					<td align="left">
						<ol>
							<li>El <strong>Administrador</strong> navega a la sección "Configuración IA" &gt; "Base de Conocimiento".
							</li>
							<li>El <strong>Sistema</strong> muestra una lista de todos los artículos de conocimiento, indicando su
								<code>Título</code>, <code>Estado</code> (ej. Activo, Inactivo, Procesando) y
								<code>Fecha de Última Modificación</code>.
							</li>
							<li>El <strong>Administrador</strong> crea un nuevo artículo haciendo clic en "Nuevo Artículo". </li>
							<li>El <strong>Sistema</strong> presenta un formulario para ingresar el <code>Título</code> y el
								<code>Contenido</code> del artículo.
							</li>
							<li>El <strong>Administrador</strong> completa los campos y guarda el artículo. </li>
							<li>El <strong>Sistema</strong> guarda el texto del artículo en la base de datos relacional y establece su
								estado inicial como <code>Procesando</code>. </li>
							<li><strong>Inmediatamente</strong>, el <strong>Sistema</strong> dispara un trabajo en segundo plano
								(asíncrono) para la vectorización del nuevo contenido. Este trabajo: <ol type="a">
									<li>Divide el <code>Contenido</code> en fragmentos de texto (chunks). </li>
									<li>Para cada chunk, llama a la API de embeddings para obtener su vector numérico. </li>
									<li>Almacena cada chunk de texto junto con su vector en la base de datos vectorial. </li>
									<li>Una vez que el trabajo en segundo plano finaliza con éxito, el <strong>Sistema</strong> actualiza
										el estado del artículo a <code>Activo</code>. </li>
								</ol>
							</li>
						</ol>
					<br>$</td>
				</tr>

				<tr>
					<td align="left"> <strong>Postcondición</strong><br>$</td>
					<td align="left">
						<ol>
							<li>El contenido del nuevo artículo ha sido procesado y sus vectores están almacenados en la base de datos
								vectorial.</li>
							<li>La nueva información está disponible inmediatamente para ser recuperada por el sistema de IA en la
								próxima consulta de un ticket.</li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Excepciones (Flujos Alternativos)</strong><br>$</td>
					<td align="left">
						<ul>
							<strong>E1: Falla el proceso de vectorización.</strong>
							<li> En el paso 7, la API de embeddings no está disponible o devuelve un error. </li>
							<li> El trabajo en segundo plano falla. El <strong>Sistema</strong> debe registrar el error detallado para
								su auditoría. </li>
							<li> El estado del artículo se actualiza a <code>Error en Procesamiento</code>. </li>
							<li> La interfaz de usuario debe mostrar este estado de error y, opcionalmente, proporcionar un botón para
								"Reintentar Vectorización". El contenido no será utilizado por la IA hasta que se procese con
								éxito.<br><br>
								<strong>E2: Actualización de un artículo existente.</strong>
							</li>
							<li> El Administrador edita un artículo. </li>
							<li> Al guardar, el <strong>Sistema</strong> debe invalidar y eliminar los vectores antiguos asociados a
								ese artículo de la base de datos vectorial antes de iniciar el proceso de vectorización del nuevo
								contenido (pasos 6-8). Esto es crucial para evitar que la IA utilice información
								obsoleta.<br><br>
								<strong>E3: Desactivación de un artículo.</strong>
							</li>
							<li> El Administrador cambia el estado de un artículo a <code>Inactivo</code>.<br>
							</li>
							<li>El <strong>Sistema</strong> elimina los vectores asociados de la base de datos vectorial pero conserva
								el texto en la base de datos relacional, permitiendo que sea reactivado en el futuro. </li>
						</ul>

					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Rendimiento</strong><br>$</td>
					<td align="left">
						<li>La acción de guardar el texto del artículo (paso 6) debe ser instantánea (&lt; 1 segundo). </li>
						<li>El proceso de vectorización en segundo plano (paso 7) es de larga duración y su tiempo dependerá del
							tamaño del texto y la latencia de la API de embeddings. No debe bloquear la interfaz de usuario. </li>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Frecuencia</strong><br>$</td>
					<td align="left"> Media-Baja. Se actualiza conforme evoluciona el catálogo de productos o las políticas
						internas.<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Comentarios</strong><br>$</td>
					<td align="left">
						<li>Este es uno de los casos de uso más críticos para la calidad del sistema. La regla "Garbage In, Garbage
							Out" aplica directamente aquí. La calidad, claridad y veracidad del contenido gestionado en este módulo
							determinará directamente la calidad de las respuestas generadas por la IA. </li>
						<li>La gestión de la eliminación y actualización de vectores (E2, E3) es un desafío técnico clave que debe
							ser implementado de forma robusta. </li>
					<br>$</td>
				</tr>
				<tr>
					<td>$<br>$</td>
					<td>$<br>$</td>
				</tr>
				<tr>
					<td>$<br>$</td>
					<td>$<br>$</td>
				</tr>
			</tbody>
			<thead>
				<tr>
					<th align="left"><strong>ID del Caso de Uso</strong></th>
					<th align="left">UC-15</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td align="left"> <strong>Nombre</strong><br>$</td>
					<td align="left"> Importar Órdenes (CSV)<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Actor Primario</strong><br>$</td>
					<td align="left"> Administrador<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Objetivos asociados</strong><br>$</td>
					<td align="left">
						<ol>
							<li><strong>Optimizar la Eficiencia Operativa:</strong> Enriquecer el contexto de los tickets con datos de
								órdenes para que la IA y los agentes resuelvan consultas de estado de pedido (WISMO) más rápido. </li>
							<li><strong>Mitigación de Riesgos Operativos:</strong> Proveer un mecanismo controlado y con validación
								para la ingesta de datos críticos para el negocio. </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Requisitos asociados</strong><br>$</td>
					<td align="left"> <strong>Funcionales:</strong>
						<ul>
							<li><strong>RF-DATA-00 1:</strong> Exige una interfaz para la subida de archivos CSV de órdenes. </li>
							<li><strong>RF-DATA-002:</strong> Requiere la previsualización de datos y la visualización de errores de
								validación. </li>
							<li><strong>RF-DATA-003:</strong> Especifica que el procesamiento de la importación debe ser
								asíncrono.<br><br><strong>Interfaces:</strong>
							</li>
							<li><strong>UI-04:</strong> Define la interfaz de usuario específica para la importación, previsualización
								y mapeo de columnas. </li>

						</ul>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Descripción</strong><br>$</td>
					<td align="left"> El Administrador accede a una sección específica del sistema para cargar un archivo CSV que
						contiene datos de las órdenes de venta de "GearUp Gadgets". El sistema permite previsualizar los datos,
						mapear las columnas del archivo a los campos de la base de datos y procesa la importación en segundo plano.
						El objetivo es poblar o actualizar la tabla <code>Orden</code> para enriquecer el contexto disponible para
						los agentes y la IA.<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Precondición</strong><br>$</td>
					<td align="left">
						<ol>
							<li>El Administrador ha iniciado sesión en el sistema y tiene los permisos necesarios. </li>
							<li>El Administrador tiene un archivo en formato CSV con los datos de las órdenes listo para ser cargado.
							</li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Secuencia Normal (Flujo Principal)</strong><br>$</td>
					<td align="left">
						<ol>
							<li>El <strong>Administrador</strong> navega a la sección de "Administración &gt; Importación de Datos".
							</li>
							<li>El <strong>Sistema</strong> presenta la interfaz <code>UI-04</code>, que incluye un control para
								seleccionar un archivo. </li>
							<li>El <strong>Administrador</strong> selecciona el archivo CSV de su equipo local y lo sube. </li>
							<li>El <strong>Sistema</strong> recibe el archivo, lo guarda temporalmente y realiza un análisis
								preliminar (lee las cabeceras y algunas filas de muestra). </li>
							<li>El <strong>Sistema</strong> muestra una vista de previsualización de los datos y una interfaz de mapeo
								de columnas, sugiriendo automáticamente las asignaciones si los nombres de las cabeceras coinciden con
								los campos de la base de datos (ej. <code>order_id</code>-&gt; <code>idExterno</code>).
								(<code>RF-DATA-002</code>) </li>
							<li>El <strong>Administrador</strong> revisa y confirma (o ajusta) el mapeo de columnas y hace clic en
								"Iniciar Importación". </li>
							<li>El <strong>Sistema</strong> valida la solicitud, crea un trabajo de importación en una cola de
								procesamiento y responde inmediatamente a la interfaz de usuario. (<code>RF-DATA-003</code>) </li>
							<li>La <strong>UI</strong> muestra un mensaje de confirmación: "La importación ha sido iniciada. Se te
								notificará al finalizar." y puede mostrar el nuevo trabajo en una lista con estado "En Progreso". </li>
							<li>Un <strong>Proceso en Segundo Plano</strong> (worker) toma el trabajo de la cola y comienza a procesar
								el archivo CSV fila por fila:
							</li>
							<ol type="a">
								<li>Para cada fila, valida los datos (tipos, longitudes, formatos). </li>
								<li>Busca si ya existe una <code>Orden</code> con el mismo identificador único. Si existe, la actualiza;
									si no, la crea (lógica de <code>upsert</code>). </li>
								<li>Registra el resultado de cada fila (éxito o error). </li>
								<li>Al finalizar el procesamiento, el <strong>Proceso en Segundo Plano</strong> actualiza el estado del
									trabajo a "Completado" y guarda un resumen (ej. " 1500 filas procesadas: 1490 exitosas, 10 fallidas").
								</li>
							</ol>

							<li>El <strong>Sistema</strong> notifica al <strong>Administrador</strong> sobre la finalización del
								trabajo (ej. mediante una notificación en la UI o un correo electrónico) con un enlace al resumen de la
								importación. </li>
						</ol>
					<br>$</td>
				</tr>

				<tr>
					<td align="left"> <strong>Postcondición</strong><br>$</td>
					<td align="left">
						<ol>
							<li>Los datos de las órdenes del archivo CSV están creados o actualizados en la tabla <code>Orden</code>
								de la base de datos. </li>
							<li>Se ha registrado un log detallado del proceso de importación, incluyendo las filas que fallaron y el
								motivo.</li>
							<li>El Administrador ha sido notificado del resultado. </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Excepciones (Flujos Alternativos)</strong><br>$</td>
					<td align="left">
						<ul>
							<strong>E1: Formato de archivo incorrecto.</strong>
							<li> En el paso 3, el Administrador sube un archivo que no es CSV (ej. <code>.xlsx</code>,
								<code>.pdf</code>).
							</li>
							<li> El Sistema rechaza el archivo en el frontend o backend y muestra un error: "Formato de archivo no
								válido. Por favor, sube un archivo CSV."<br><br>
								<strong>E2: El archivo CSV tiene una estructura
									inválida.</strong>
							</li>
							<li> En el paso 5, el archivo no tiene las columnas requeridas para el mapeo. </li>
							<li> El Sistema detecta la ausencia de columnas clave y deshabilita el botón "Iniciar Importación",
								mostrando un mensaje: "El archivo no contiene las columnas necesarias. Revisa el
								formato."<br><br>
								<strong>E3: Errores de validación en filas específicas.</strong>
							</li>
							<li> Durante el paso 9, el proceso en segundo plano encuentra filas con datos malformados (ej. una fecha
								en formato incorrecto, un campo requerido vacío).</li>
							<li> El proceso ignora/descarta la fila inválida, registra el error específico y el número de línea en el
								log de la importación, y continúa con el resto del archivo. El trabajo se marcará como "Completado con
								errores".<br><br>
								<strong>E4: Falla crítica del trabajo de importación.</strong>
							</li>
							<li> Durante el paso 9, ocurre un error irrecuperable (ej. se pierde la conexión con la base de datos).
							</li>
							<li> El trabajo de importación se detiene, se revierte cualquier transacción parcial si es posible, y su
								estado se actualiza a "Fallido". Se genera un log del error crítico para diagnóstico técnico.
							</li>
						</ul>
						<ul>

						</ul>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Rendimiento</strong><br>$</td>
					<td align="left"> La carga del archivo y la respuesta de la UI (paso 8) deben ser casi instantáneas. El
						procesamiento en segundo plano (paso 9) debe ser capaz de procesar al menos 10,000 registros por minuto.
					<br>$</td>
				</tr>
				<tr>
					<td>$<br>$</td>
					<td>$<br>$</td>
				</tr>
				<tr>
					<td>$<br>$</td>
					<td>$<br>$</td>
				</tr>
			</tbody>
			<thead>
				<tr>
					<th align="left"><strong>ID del Caso de Uso</strong></th>
					<th align="left">UC-16</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td align="left"> <strong>Nombre</strong><br>$</td>
					<td align="left"> Gestionar Usuarios<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Actor Primario</strong><br>$</td>
					<td align="left"> Administrador<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Actor Secundario(s)</strong><br>$</td>
					<td align="left"> <strong>Supabase Auth</strong><br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Objetivos asociados</strong><br>$</td>
					<td align="left">
						<ol>
							<li><strong>Mitigación de Riesgos Operativos:</strong> Controlar el acceso al sistema, asignar privilegios
								correctos según el rol y gestionar de forma segura el ciclo de vida del personal para mantener la
								seguridad de los datos. </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Requisitos asociados</strong><br>$</td>
					<td align="left"> <strong>Funcionales:</strong>
						<ul>
							<li><strong>RF-ADMIN-00 1:</strong> Define explícitamente la capacidad de un administrador para gestionar
								usuarios y roles.<br><br><strong>No Funcionales:</strong>
							</li>
							<li><strong>NFR-SEC-00 1:</strong> Requiere que el acceso a los endpoints esté protegido por
								JWT.<br><br><strong>Interfaces:</strong> </li>
							<li><strong>API-04:</strong> Indica la dependencia de Supabase Auth para la autenticación, lo cual impacta
								directamente cómo se gestionan las identidades. </li>

						</ul>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Descripción</strong><br>$</td>
					<td align="left"> El Administrador utiliza la interfaz de gestión de usuarios para realizar operaciones de
						Crear, Leer, Actualizar y Eliminar (CRUD) sobre las cuentas de usuario del sistema. Esto incluye invitar a
						nuevos agentes, cambiar sus roles (ej. de Triaje a Especialista) y desactivar sus cuentas. El sistema se
						coordina con un servicio de identidad externo (Supabase Auth) para la creación y gestión de credenciales.
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Precondición</strong><br>$</td>
					<td align="left">
						<ol>
							<li>El Administrador ha iniciado sesión en el sistema y tiene los permisos necesarios. </li>
							<li>La integración con el servicio de autenticación (Supabase Auth) está configurada y funcionando. </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Secuencia Normal (Flujo Principal)</strong><br>$</td>
					<td align="left">
						<ul>
							<strong>Flujo 1: Crear un nuevo usuario</strong>
							<li>El <strong>Administrador</strong> navega a la sección de "Administración &gt; Gestión de Usuarios".
							</li>
							<li>El <strong>Sistema</strong> muestra una lista de los usuarios existentes. </li>
							<li>El <strong>Administrador</strong> hace clic en "Invitar Usuario". </li>
							<li>El <strong>Sistema</strong> presenta un formulario para ingresar el Email, Nombre y Rol del nuevo
								usuario. </li>
							<li>El <strong>Administrador</strong> completa los datos y envía el formulario. </li>
							<li>El <strong>Sistema</strong> valida los datos (ej. formato de email válido). </li>
							<li>El <strong>Sistema</strong> realiza una llamada a la API de <strong>Supabase Auth</strong> para
								invitar al nuevo usuario (<code>API-04</code>). </li>
							<li><strong>Supabase Auth</strong> envía un correo de invitación al email proporcionado para que el nuevo
								usuario establezca su contraseña. </li>
							<li>Tras la confirmación exitosa de Supabase, el <strong>Sistema</strong> crea un registro local en su
								tabla <code>Usuario</code>, asociando el ID de usuario de Supabase con el rol y otros metadatos de la
								aplicación. </li>
							<li>La lista de usuarios en la UI se actualiza, mostrando al nuevo usuario con un estado de "Invitación
								enviada".<br><br><strong>Flujo 2: Modificar el rol de un usuario existente</strong> </li>
							<li>El <strong>Administrador</strong>, en la lista de usuarios, localiza al usuario que desea modificar y
								hace clic en "Editar". </li>
							<li>El <strong>Sistema</strong> muestra los detalles del usuario, permitiendo la edición del campo "Rol".
							</li>
							<li>El <strong>Administrador</strong> cambia el rol (ej. de <code>Agente de Triaje</code> a
								<code>Agente Especialista</code>).
							</li>
							<li>El <strong>Administrador</strong> guarda los cambios. </li>
							<li>El <strong>Sistema</strong> actualiza el campo <code>rol</code> en su tabla local <code>Usuario</code>
								para ese registro. No se requiere una llamada a Supabase si el rol es un concepto puramente de la
								aplicación. </li>
							<li>El <strong>Sistema</strong> muestra un mensaje de éxito y actualiza la lista.<br><br><strong>Flujo 3:
									Desactivar un usuario</strong> </li>
							<li>El <strong>Administrador</strong>, en la lista de usuarios, localiza al usuario y hace clic en
								"Desactivar". </li>
							<li>El <strong>Sistema</strong> muestra un diálogo de confirmación. </li>
							<li>El <strong>Administrador</strong> confirma la acción. </li>
							<li>El <strong>Sistema</strong> realiza una llamada a la API de <strong>Supabase Auth</strong> para
								deshabilitar o eliminar al usuario de la plataforma de autenticación. </li>
							<li>El <strong>Sistema</strong> actualiza el registro local del usuario, marcándolo como inactivo (soft
								delete). </li>
							<li>El usuario desactivado ya no podrá iniciar sesión y su token JWT será invalidado. </li>
						</ul>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Postcondición</strong><br>$</td>
					<td align="left">
						<ol>
							<li><strong>Crear:</strong> Se ha enviado una invitación y existe un nuevo registro de usuario en estado
								pendiente en Supabase y en la base de datos local. </li>
							<li><strong>Actualizar:</strong> El rol del usuario ha sido modificado en la base de datos local. </li>
							<li><strong>Desactivar:</strong> El usuario ya no puede autenticarse en el sistema y su estado local
								refleja la inactividad. </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Excepciones (Flujos Alternativos)</strong><br>$</td>
					<td align="left">
						<ul>
							<strong>E1: El email del nuevo usuario ya existe.</strong>
							<li> En el Flujo 1, paso 7, la API de Supabase Auth devuelve un error indicando que el usuario ya está
								registrado.</li>
							<li> El Sistema muestra un mensaje de error al Administrador: "Un usuario con este correo electrónico ya
								existe."</li><br><br>
							<strong>E2: Falla la comunicación con el servicio de autenticación.</strong>
							<li> Durante la creación (paso 7) o desactivación (paso 4) de un usuario, la API de Supabase no responde o
								devuelve un error.</li>
							<li> El Sistema no realiza ningún cambio en su base de datos local, registra el error y muestra un mensaje
								genérico: "No se pudo completar la operación con el servicio de autenticación. Inténtelo más
								tarde."<br><br>
								<strong>E3: Intento de eliminar al último administrador.</strong>
							</li>
							<li> En el Flujo 3, el Administrador intenta desactivar su propia cuenta o la del único usuario restante
								con el rol de <code>Administrador</code>.<br>
							</li>
							<li>El Sistema aplica una regla de negocio que impide la acción y muestra un mensaje: "No se puede
								eliminar al último administrador del sistema."
							</li>
						</ul>

						<ul>

						</ul>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Seguridad</strong><br>$</td>
					<td align="left"> Todas las acciones de este caso de uso deben ser registradas en un log de auditoría
						(<code>UC-22</code>) para rastrear quién realizó los cambios, qué cambios se hicieron y cuándo.<br>$</td>
				</tr>
				<tr>
					<td>$<br>$</td>
					<td>$<br>$</td>
				</tr>
				<tr>
					<td>$<br>$</td>
					<td>$<br>$</td>
				</tr>
			</tbody>
			<thead>
				<tr>
					<th align="left"><strong>ID del Caso de Uso</strong></th>
					<th align="left">UC-17</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td align="left"> <strong>Nombre</strong><br>$</td>
					<td align="left"> Gestionar Etiquetas Maestras<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Actor Primario</strong><br>$</td>
					<td align="left"> Administrador<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Actor Secundario(s)</strong><br>$</td>
					<td align="left"> <strong>Agente Especialista/Triaje</strong> (Utiliza las etiquetas)<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Objetivos asociados</strong><br>$</td>
					<td align="left">
						<ol>
							<li><strong>Generar Inteligencia de Negocio:</strong> Estandarizar la taxonomía de clasificación para
								asegurar que los datos de etiquetado sean limpios y fiables, permitiendo la generación de reportes
								precisos. </li>
							<li><strong>Optimizar la Eficiencia Operativa:</strong> Proveer a los agentes una lista predefinida de
								etiquetas para agilizar el proceso de categorización manual. </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Requisitos asociados</strong><br>$</td>
					<td align="left"> <strong>Funcionales:</strong>
						<ul>
							<li><strong>RF-ADMIN-00 1:</strong> Define la capacidad del administrador para gestionar configuraciones
								del sistema, incluyendo esta taxonomía.
							</li>
							<li><strong>RF-AGENT-007:</strong> Este caso de uso es un prerrequisito para que los agentes puedan
								utilizar y gestionar etiquetas en un ticket específico. </li>

						</ul>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Descripción</strong><br>$</td>
					<td align="left"> El Administrador del sistema realiza operaciones de Crear, Leer, Actualizar y Eliminar
						(CRUD) sobre el catálogo central de <code>Etiqueta</code>s. Este catálogo define las opciones de
						clasificación que estarán disponibles para los agentes y para el motor de IA en todo el sistema.<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Precondición</strong><br>$</td>
					<td align="left">
						<ol>
							<li>El usuario está autenticado en el sistema. </li>
							<li>El usuario tiene asignado el rol de <code>Administrador</code>. </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Secuencia Normal (Flujo Principal)</strong><br>$</td>
					<td align="left">
						<ul>
							<strong>A. Listar Etiquetas</strong>
							<li>El <strong>Administrador</strong> navega a la sección de "Administración &gt; Etiquetas". </li>
							<li>El <strong>Sistema</strong> recupera y muestra una tabla con todas las etiquetas maestras existentes.
								Para cada etiqueta, la tabla muestra su nombre, descripción, una muestra de su color y, opcionalmente,
								la cantidad de tickets activos que la utilizan.<br><br><strong>B. Crear una Nueva Etiqueta</strong>
							</li>
							<li>El <strong>Administrador</strong> hace clic en el botón "Crear Nueva Etiqueta". </li>
							<li>El <strong>Sistema</strong> presenta un formulario modal o una nueva página con campos para: Nombre
								(requerido, único), Descripción (opcional) y Selector de Color (requerido). </li>
							<li>El <strong>Administrador</strong> completa los datos y hace clic en "Guardar". </li>
							<li>El <strong>Sistema</strong> valida que el nombre de la etiqueta no exista ya (de forma no sensible a
								mayúsculas/minúsculas). </li>
							<li>El <strong>Sistema</strong> crea un nuevo registro en la tabla <code>Etiqueta</code> y cierra el
								formulario. </li>
							<li>El <strong>Sistema</strong> actualiza la tabla de etiquetas para mostrar la nueva entrada y muestra
								una notificación de éxito.<br><br><strong>C. Editar una Etiqueta Existente</strong> </li>
							<li>El <strong>Administrador</strong> localiza una etiqueta en la tabla y hace clic en el icono "Editar".
							</li>
							<li>El <strong>Sistema</strong> presenta el mismo formulario que para la creación, pero pre-poblado con
								los datos de la etiqueta seleccionada. </li>
							<li>El <strong>Administrador</strong> modifica la descripción o el color y hace clic en "Guardar". (El
								nombre podría ser inmutable o su edición sujeta a reglas estrictas). </li>
							<li>El <strong>Sistema</strong> valida los datos y actualiza el registro correspondiente en la base de
								datos. </li>
							<li>El <strong>Sistema</strong> actualiza la fila en la tabla y muestra una notificación de
								éxito.<br><br><strong>D. Eliminar una Etiqueta</strong> </li>
							<li>El <strong>Administrador</strong> hace clic en el icono "Eliminar" de una etiqueta específica. </li>
							<li>El <strong>Sistema</strong> muestra un cuadro de diálogo de confirmación: "¿Estás seguro de que
								quieres eliminar la etiqueta '[Nombre de la Etiqueta]'? Esta acción no se puede deshacer." </li>
							<li>El <strong>Administrador</strong> confirma la acción. </li>
							<li>El <strong>Sistema</strong> verifica que la etiqueta no esté siendo utilizada por ningún
								<code>Ticket</code>.
							</li>
							<li>Si la verificación es exitosa, el <strong>Sistema</strong> elimina el registro de la etiqueta de la
								base de datos. </li>
							<li>El <strong>Sistema</strong> elimina la fila de la tabla y muestra una notificación de éxito. </li>
						</ul>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Postcondición</strong><br>$</td>
					<td align="left">
						<ol>
							<li>El catálogo de <code>Etiqueta</code>s en la base de datos refleja los cambios realizados por el
								Administrador. </li>
							<li>Los cambios están disponibles inmediatamente para su uso en todo el sistema. </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Excepciones (Flujos Alternativos)</strong><br>$</td>
					<td align="left">
						<ul>
							<strong>E1: Intento de crear una etiqueta con un nombre duplicado.</strong>
							<li> En el paso B.4, el sistema detecta que el nombre ya existe. </li>
							<li> El <strong>Sistema</strong> no crea la etiqueta. Muestra un mensaje de error en el formulario: "Ya
								existe una etiqueta con este nombre." y resalta el campo de nombre. El formulario permanece abierto para
								que el Administrador corrija el error.<br><br>
								<strong>E2: Intento de eliminar una etiqueta en
									uso.</strong>
							</li>
							<li> En el paso D.4, el sistema detecta que la etiqueta está asociada a uno o más tickets. </li>
							<li> El <strong>Sistema</strong> aborta la operación de eliminación.<br>
							</li>
							<li>El <strong>Sistema</strong> muestra un mensaje de error informativo: "No se puede eliminar la etiqueta
								'[Nombre de la Etiqueta]' porque está siendo utilizada por [N] tickets. Considere editarla o archivarla
								en su lugar."<br><br>
								<strong>E3: Error de sistema o de red.</strong>
							</li>

							<li> Durante cualquier operación de guardado o eliminación, se produce un error de comunicación con el
								servidor o un fallo en la base de datos.</li>
							<li> El <strong>Sistema</strong> muestra una notificación de error genérica: "Ha ocurrido un error
								inesperado. Por favor, inténtalo de nuevo." y registra el error detallado internamente para su posterior
								análisis.
							</li>
						</ul>
						<ul>

						</ul>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Comentarios</strong><br>$</td>
					<td align="left">
						<li>Por razones de integridad de datos, es una práctica recomendada no permitir la eliminación física de
							etiquetas en uso (ver E2). Una alternativa superior es implementar una función de "Archivar" que la oculte
							de futuras asignaciones pero preserve el registro histórico en los tickets existentes. </li>
						<li>La validación del nombre de la etiqueta debe ser, como mínimo, <em>case-insensitive</em> para evitar
							duplicados como "pago" y "Pago". </li>
					<br>$</td>
				</tr>
				<tr>
					<td>$<br>$</td>
					<td>$<br>$</td>
				</tr>
				<tr>
					<td>$<br>$</td>
					<td>$<br>$</td>
				</tr>
			</tbody>
			<thead>
				<tr>
					<th align="left"><strong>ID del Caso de Uso</strong></th>
					<th align="left">UC-18</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td align="left"> <strong>Nombre</strong><br>$</td>
					<td align="left"> Gestionar Integraciones<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Actor Primario</strong><br>$</td>
					<td align="left"> Administrador<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Actor Secundario(s)</strong><br>$</td>
					<td align="left"> <strong>Servicios Externos</strong> (Mailgun, OpenRouter, Supabase)<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Objetivos asociados</strong><br>$</td>
					<td align="left">
						<ol>
							<li><strong>Mitigación de Riesgos Operativos:</strong> Centralizar la gestión de credenciales y
								configuración sensible en una interfaz segura para facilitar la mantenibilidad y asegurar la
								conectividad con servicios de terceros. </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Requisitos asociados</strong><br>$</td>
					<td align="left"> <strong>Funcionales:</strong>
						<ul>
							<li><strong>RF-ADMIN-00 1:</strong> Es la capacidad general del administrador para gestionar el
								sistema.<br><br><strong>Interfaces:</strong> </li>
							<li><strong>API-0 1, API-02, API-03, API-04, API-05:</strong> Este caso de uso proporciona la interfaz de
								usuario para configurar los parámetros (ej. claves de API) necesarios para que estas integraciones de
								software funcionen. </li>
						</ul>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Descripción</strong><br>$</td>
					<td align="left"> El Administrador utiliza una sección segura de la interfaz para configurar y validar los
						parámetros de conexión con los servicios externos de los que depende NoraAI. Esto incluye la introducción de
						claves de API, dominios y otros datos de configuración necesarios para Mailgun (correo), OpenRouter (LLM) y
						Supabase (almacenamiento y autenticación).<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Precondición</strong><br>$</td>
					<td align="left">
						<ol>
							<li>El usuario está autenticado en el sistema. </li>
							<li>El usuario tiene asignado el rol de <code>Administrador</code>. </li>
							<li>El Administrador tiene acceso a las credenciales (ej. claves de API) obtenidas de los paneles de
								administración de los servicios externos (Mailgun, OpenRouter).</li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Secuencia Normal (Flujo Principal)</strong><br>$</td>
					<td align="left">
						<ol>
							<li>El <strong>Administrador</strong> navega a la sección "Administración &gt; Integraciones". </li>
							<li>El <strong>Sistema</strong> muestra una lista de las integraciones que requiere (ej. "Servicio de
								Email Mailgun", "Proveedor LLM OpenRouter", "Almacenamiento Supabase Storage"). </li>

							<li>El <strong>Administrador</strong> selecciona la integración que desea configurar, por ejemplo,
								"Mailgun". </li>
							<li>El <strong>Sistema</strong> presenta un formulario con los campos específicos para esa integración.
								Por ejemplo, para Mailgun:
							</li>
							<ol type="a">
								<li> Clave de API (campo de contraseña, requerido) </li>
								<li> Dominio de envío (requerido) </li>
								<li> Clave de firma del Webhook (campo de contraseña, requerido para <code>API-02</code>) </li>
								<li> URL del Webhook de entrada (campo de solo lectura, para que el admin la copie y pegue en Mailgun)
								</li>
							</ol>
							<li>El <strong>Administrador</strong> introduce o actualiza las credenciales en los campos. </li>
							<li>El <strong>Administrador</strong> hace clic en el botón "Guardar y Probar Conexión". </li>
							<li>El <strong>Sistema</strong> realiza dos acciones: <ol type="a">
									<li>Primero, guarda la configuración en la base de datos de forma segura (los secretos deben estar
										encriptados en reposo). </li>
									<li>Segundo, utiliza las nuevas credenciales para realizar una llamada de prueba a la API del servicio
										externo (ej. intenta enviar un email de prueba a una dirección designada usando la API de Mailgun).
									</li>
								</ol>
							</li>
							<li>El <strong>Sistema</strong> recibe una respuesta exitosa de la API externa. </li>
							<li>El <strong>Sistema</strong> muestra una notificación de éxito persistente en la interfaz: "¡Éxito!
								La conexión con Mailgun se ha verificado correctamente." </li>

						</ol>
					<br>$</td>
				</tr>

				<tr>
					<td align="left"> <strong>Postcondición</strong><br>$</td>
					<td align="left">
						<ol>
							<li>Las credenciales para el servicio externo están actualizadas y almacenadas de forma segura en la base
								de datos.</li>
							<li>Se ha verificado que el sistema puede comunicarse exitosamente con el servicio externo utilizando la
								nueva configuración.</li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Excepciones (Flujos Alternativos)</strong><br>$</td>
					<td align="left">
						<ul>
							<strong>E1: Falla la prueba de conexión.</strong>
							<li> En el paso 7b, la llamada a la API del servicio externo falla (ej. por una clave de API incorrecta).
							</li>
							<li> El <strong>Sistema</strong> recibe una respuesta de error del servicio externo. </li>
							<li> El <strong>Sistema</strong> almacena la configuración pero la marca como "no verificada" o "con
								error". </li>
							<li> El <strong>Sistema</strong> muestra una notificación de error detallada y útil: "Error al conectar
								con Mailgun. La API devolvió el siguiente error: '401 Unauthorized Forbidden'. Por favor, verifica tu
								Clave de API."<br><br>
								<strong>E2: El servicio externo no está
									disponible.</strong>
							</li>
							<li> En el paso 7b, la llamada a la API del servicio externo falla no por credenciales incorrectas, sino
								por un problema de red o porque el servicio está caído (ej. timeout o error 503).</li>
							<li> El <strong>Sistema</strong> muestra un mensaje de error específico para esta situación: "No se pudo
								establecer conexión con los servidores de Mailgun. Por favor, comprueba el estado del servicio e
								inténtalo de nuevo más tarde."<br><br>
								<strong>E3: Los datos introducidos tienen un formato
									inválido.</strong>
							</li>
							<li> En el paso 6, el Administrador intenta guardar sin rellenar un campo requerido. </li>
							<li> El <strong>Sistema</strong>, antes de intentar guardar o probar la conexión, realiza una validación
								local y muestra un error junto al campo: "Este campo es requerido."
							</li>
						</ul>
						<ul>

						</ul>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Comentarios</strong><br>$</td>
					<td align="left">
						<li><strong>Seguridad Crítica:</strong> Las credenciales (claves de API, tokens, secretos de firma) NUNCA
							deben almacenarse como texto plano. Deben ser encriptadas en la base de datos utilizando un mecanismo de
							encriptación fuerte. Además, nunca deben ser expuestas de nuevo en la interfaz de usuario después de ser
							guardadas (los campos de contraseña siempre deben aparecer vacíos o con placeholders al volver a editar).
						</li>
						<li>La funcionalidad "Guardar y Probar" es fundamental. Separar estas acciones podría dejar al sistema en un
							estado no funcional si el administrador guarda credenciales incorrectas y no se da cuenta. </li>
					<br>$</td>
				</tr>
				<tr>
					<td>$<br>$</td>
					<td>$<br>$</td>
				</tr>
				<tr>
					<td>$<br>$</td>
					<td>$<br>$</td>
				</tr>
			</tbody>
			<thead>
				<tr>
					<th align="left"><strong>ID del Caso de Uso</strong></th>
					<th align="left">UC-19</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td align="left"> <strong>Nombre</strong><br>$</td>
					<td align="left"> Reasignar Ticket Manualmente<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Actor Primario</strong><br>$</td>
					<td align="left"> Agente de Triaje<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Actor Secundario(s)</strong><br>$</td>
					<td align="left"> <strong>Agente Especialista</strong> (Recibe el ticket)<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Actores Secundarios</strong><br>$</td>
					<td align="left"> Agente Especialista, Administrador (heredan la capacidad)<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Objetivos asociados</strong><br>$</td>
					<td align="left">
						<ol>
							<li><strong>Optimizar el Enrutamiento:</strong> Permitir que un agente con conocimiento del equipo y de la
								carga de trabajo asigne un ticket directamente al especialista más adecuado, saltándose la cola general
								de los Agentes Especialistas. </li>
							<li><strong>Mejorar la Colaboración:</strong> Facilitar la transferencia de tickets entre colegas cuando
								se requiere una segunda opinión o la intervención de un experto específico. </li>
							<li><strong>Aumentar la Velocidad de Resolución:</strong> Reducir el tiempo que un ticket pasa en una cola
								general al dirigirlo inmediatamente a la persona que puede resolverlo. </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Requisitos asociados</strong><br>$</td>
					<td align="left"> <strong>Funcionales:</strong>
						<ul>
							<li><strong>RF-AGENT-005 (Relacionado):</strong> Este caso de uso es una alternativa más específica a la
								escalada general. Un agente puede elegir escalar a la cola o reasignar a un individuo. </li>
							<li><strong>RF-AGENT-008 (Relacionado):</strong> La capacidad de @mencionar es clave para la colaboración,
								y la nota de reasignación es una forma de mención contextual.
							</li>
							<li><strong>RF-ADMIN-005:</strong> El historial del ticket debe reflejar claramente la acción de
								reasignación.<br><br><strong>No Funcionales:</strong> </li>
							<li><strong>NFR-USAB-00 1 (Implícito):</strong> La acción de reasignar debe ser accesible y fácil de
								ejecutar desde la vista del ticket. </li>

						</ul>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Descripción</strong><br>$</td>
					<td align="left"> Un Agente de Triaje, al revisar un ticket, identifica que este requiere la atención de un
						Agente Especialista específico. En lugar de escalarlo a la cola general de los Agentes Especialistas, el
						agente utiliza la
						funcionalidad de reasignación para transferir la propiedad del ticket directamente a su colega, añadiendo
						opcionalmente una nota interna para dar contexto.<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Precondición</strong><br>$</td>
					<td align="left">
						<ol>
							<li>El Agente de Triaje ha iniciado sesión en el sistema. </li>
							<li>Existe al menos un ticket en un estado que permite la reasignación (ej. <code>ia_sugerido</code>,
								<code>abierto</code>).
							</li>
							<li>Existen otros usuarios (Agentes Especialistas) en el sistema a los cuales se les puede asignar el
								ticket.</li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Secuencia Normal (Flujo Principal)</strong><br>$</td>
					<td align="left">
						<ol>
							<li>El <strong>Agente de Triaje</strong> abre un ticket desde su vista de triaje. </li>
							<li>El <strong>Agente de Triaje</strong> evalúa el contenido y decide que un colega específico es el más
								indicado para resolverlo. </li>
							<li>El <strong>Agente</strong> selecciona la acción "Reasignar" en la interfaz del ticket. </li>
							<li>El <strong>Sistema</strong> presenta una lista de usuarios elegibles (Agentes Especialistas,
								Administradores), mostrando preferiblemente su estado actual (ej. 'En línea', 'Ausente') o su carga de
								trabajo actual (ej. '5 tickets asignados'). </li>
							<li>El <strong>Agente</strong> selecciona al Agente Especialista deseado de la lista. </li>
							<li>El <strong>Sistema</strong> ofrece un campo de texto para que el agente añada una nota interna
								explicando el motivo de la reasignación (ej. "@Carlos, este cliente tiene un problema similar al de la
								semana pasada. ¿Puedes echarle un vistazo?"). </li>
							<li>El <strong>Agente</strong> confirma la reasignación. </li>
							<li>El <strong>Sistema</strong> valida la acción y actualiza el registro del <code>Ticket</code>: <ol
									type="a">
									<li>Cambia el campo <code>asignadoAUsuarioId</code> al ID del Agente Especialista seleccionado. </li>
									<li>Actualiza el <code>estado</code> del ticket a <code>escalado_nivel_2</code> (o
										<code>abierto</code>, si ya estaba en ese nivel).
									</li>
									<li>Crea un registro en el <code>LogEvento</code> del ticket indicando: "Reasignado por [Agente de
										Triaje] a [Agente Especialista] el [Fecha/Hora]". </li>
									<li>Si se añadió una nota, la guarda como un <code>Mensaje</code> de tipo <code>interno</code>
										asociado al ticket. </li>
								</ol>
							</li>
							<li>El <strong>Sistema</strong> envía una notificación en tiempo real (in-app) al Agente Especialista
								recién asignado. </li>
							<li>El <strong>Sistema</strong> actualiza la interfaz del Agente de Triaje, mostrando que el ticket ya
								no está en su cola y confirmando la reasignación exitosa. </li>

						</ol>
					<br>$</td>
				</tr>

				<tr>
					<td align="left"> <strong>Postcondición</strong><br>$</td>
					<td align="left">
						<ol>
							<li>El <code>Ticket</code> ya no está en la cola de triaje. </li>
							<li>El <code>Ticket</code> está asignado al Agente Especialista seleccionado. </li>
							<li>La acción de reasignación ha quedado registrada en el historial del ticket para fines de auditoría.
							</li>
							<li>El Agente Especialista ha sido notificado de su nueva asignación. </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Excepciones (Flujos Alternativos)</strong><br>$</td>
					<td align="left">
						<ul>
							<strong>E1: El agente seleccionado ya no está disponible.</strong>
							<li> En el paso 7, el agente de destino ha sido desactivado o ha cerrado sesión justo antes de la
								confirmación.</li>
							<li> El Sistema invalida la acción y muestra un mensaje de error: "No se puede asignar el ticket. El
								usuario [Nombre] ya no está disponible. Por favor, seleccione otro agente."<br><br>
								<strong>E2: Ocurre un
									conflicto de concurrencia.</strong>
							</li>
							<li> Mientras el Agente de Triaje está decidiendo a quién reasignar, otro agente o un proceso automático
								cambia el estado del ticket (ej. el cliente responde).</li>
							<li> En el paso 8, el Sistema detecta que el estado del ticket ha cambiado. Rechaza la acción y notifica
								al agente: "El estado de este ticket ha cambiado. Por favor, refresque la página para ver la última
								actualización antes de reasignar."</li>
						</ul>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Rendimiento</strong><br>$</td>
					<td align="left"> La búsqueda de agentes disponibles (paso 4) y la confirmación de la reasignación (paso 10)
						deben completarse en menos de 2 segundos cada una.<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Frecuencia</strong><br>$</td>
					<td align="left"> Media. Dependerá de la dinámica del equipo de soporte.<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Comentarios</strong><br>$</td>
					<td align="left">
						<li>La notificación al agente recién asignado (paso 9) es crítica para la fluidez del proceso. Sin ella, el
							ticket podría quedar estancado hasta que el agente revise manualmente su cola. </li>
						<li>Por seguridad y auditoría, el sistema debe registrar quién realiza la reasignación y cuándo. </li>
					<br>$</td>
				</tr>
				<tr>
					<td>$<br>$</td>
					<td>$<br>$</td>
				</tr>
				<tr>
					<td>$<br>$</td>
					<td>$<br>$</td>
				</tr>
			</tbody>
			<thead>
				<tr>
					<th align="left"><strong>ID del Caso de Uso</strong></th>
					<th align="left">UC-20</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td align="left"> <strong>Nombre</strong><br>$</td>
					<td align="left"> Generar Reportes (Exportar)<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Actor Primario</strong><br>$</td>
					<td align="left"> Agente Especialista<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Actor Secundario(s)</strong><br>$</td>
					<td align="left"> <strong>Sistema</strong> (Para el proceso de streaming/generación de CSV)<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Actores Secundarios</strong><br>$</td>
					<td align="left"> Administrador<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Objetivos asociados</strong><br>$</td>
					<td align="left">
						<ol>
							<li><strong>Habilitar el Análisis Externo:</strong> Permitir que los datos de los tickets sean extraídos
								del sistema para su análisis en herramientas de BI, hojas de cálculo u otros sistemas. </li>
							<li><strong>Generar Inteligencia de Negocio:</strong> Facilitar la identificación de tendencias, cuellos
								de botella y patrones de comportamiento de los clientes mediante el análisis de grandes volúmenes de
								datos. </li>
							<li><strong>Cumplir con Requisitos de Auditoría y Archivo:</strong> Proporcionar un mecanismo para crear
								copias de seguridad o archivos históricos de las interacciones con los clientes. </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Requisitos asociados</strong><br>$</td>
					<td align="left"> <strong>Funcionales:</strong>
						<ul>
							<li><strong>RF-DATA-004:</strong> El sistema deberá permitir la exportación de una lista filtrada de
								tickets a un archivo CSV. </li>
							<li><strong>RF-DATA-005:</strong> El sistema deberá poder generar un reporte de resumen.<br><br><strong>No
									Funcionales:</strong>
							</li>
							<li><strong>NFR-PERF-00 1:</strong> La exportación de grandes volúmenes debe usar streaming para evitar
								timeouts y uso excesivo de memoria. </li>

						</ul>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Descripción</strong><br>$</td>
					<td align="left"> Un usuario autorizado (Agente o Admin) necesita obtener un conjunto de datos de
						tickets para análisis externo. El usuario accede a la sección de reportes, aplica una serie de filtros para
						definir el conjunto de datos deseado (ej. por rango de fechas, estado, etiqueta) y solicita la exportación.
						El sistema procesa la solicitud en segundo plano y notifica al usuario cuando el archivo CSV está listo para
						ser descargado.<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Precondición</strong><br>$</td>
					<td align="left">
						<ol>
							<li>El usuario ha iniciado sesión en el sistema y tiene los permisos necesarios para acceder a la
								funcionalidad de reportes.</li>
							<li>Existen datos de tickets en la base de datos que pueden ser exportados. </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Secuencia Normal (Flujo Principal)</strong><br>$</td>
					<td align="left">
						<ol>
							<li>El <strong>Usuario</strong> navega a la sección "Reportes" o "Tickets" de la aplicación. </li>
							<li>El <strong>Sistema</strong> presenta una interfaz con un conjunto de controles de filtrado, como:
								Rango de Fechas, Estado del Ticket, Etiqueta(s), Agente Asignado, Cliente. </li>
							<li>El <strong>Usuario</strong> selecciona y aplica los filtros deseados. </li>
							<li>El <strong>Sistema</strong> actualiza la vista, mostrando una vista previa paginada de los tickets que
								coinciden con los criterios y un contador total de registros ("Se encontraron 1,234 tickets"). </li>
							<li>El <strong>Usuario</strong> hace clic en el botón "Exportar a CSV". </li>
							<li>El <strong>Sistema</strong> inicia un trabajo asíncrono en el backend para generar el archivo CSV.
								Este proceso no bloquea la interfaz del usuario. </li>
							<li>El <strong>Sistema</strong> muestra una notificación inmediata en la UI: "Tu exportación ha comenzado.
								Te notificaremos cuando el archivo esté listo para descargar." </li>
							<ol type="a">
								<li>El trabajo en segundo plano consulta la base de datos con los filtros aplicados y procesa los
									resultados en un flujo (<code>stream</code>) para construir el archivo CSV, garantizando un bajo
									consumo
									de memoria (<code>NFR-PERF-001</code>). </li>
								<li>Una vez que el archivo se ha generado y almacenado temporalmente de forma segura, el
									<strong>Sistema</strong> envía una notificación al usuario (ej. un ícono en la barra de navegación y/o
									un correo electrónico).
								</li>
							</ol>
							<li>El <strong>Usuario</strong> hace clic en la notificación o en el enlace proporcionado. </li>
							<li>El <strong>Sistema</strong> inicia la descarga del archivo CSV en el navegador del usuario. </li>
							<li>El <strong>Sistema</strong> crea un registro en el <code>LogEvento</code> para auditar la acción: "El
								usuario [Nombre de Usuario] exportó [Número] tickets con los filtros [Resumen de Filtros] el
								[Fecha/Hora]". </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Postcondición</strong><br>$</td>
					<td align="left">
						<ol>
							<li>El usuario ha descargado un archivo CSV que contiene los datos de los tickets que coinciden con los
								filtros aplicados.</li>
							<li>La acción de exportación ha quedado registrada para fines de auditoría. </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Excepciones (Flujos Alternativos)</strong><br>$</td>
					<td align="left">
						<ul>
							<strong>E1: No se encuentran resultados.</strong>
							<li> En el paso 4, ningún ticket coincide con los filtros aplicados. </li>
							<li> El Sistema muestra el mensaje "No se encontraron tickets para los criterios seleccionados." y el
								botón "Exportar a CSV" permanece deshabilitado.<br><br>
								<strong>E2: El proceso de exportación
									falla.</strong>
							</li>
							<li> Durante el paso 8, el trabajo en segundo plano encuentra un error irrecuperable (ej. pérdida de
								conexión con la base de datos).</li>
							<li> El Sistema detiene el proceso, registra el error y notifica al usuario: "Lo sentimos, ha ocurrido un
								error al generar tu exportación. Por favor, inténtalo de nuevo más tarde."<br><br>
								<strong>E3: El
									conjunto de datos es demasiado grande.</strong><br>
							</li>
							<li>Si, a pesar del streaming, el conjunto de datos excede un límite de seguridad predefinido (ej. &gt;
								500,000 registros), el sistema puede detener la exportación.</li>

							<li> El Sistema notifica al usuario: "El conjunto de datos es demasiado grande para exportar de una vez.
								Por favor, reduce el rango de fechas o aplica filtros más específicos."
							</li>
						</ul>
						<ul>

						</ul>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Rendimiento</strong><br>$</td>
					<td align="left"> El tiempo para generar la notificación de que la exportación está lista (paso 9) debería ser
						razonable, incluso para grandes volúmenes. Ej: para 10,000 registros, el tiempo no debería exceder los 2
						minutos.<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Frecuencia</strong><br>$</td>
					<td align="left"> Baja-Media. Se espera que sea utilizada principalmente por Administradores de
						forma semanal o mensual.<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Comentarios</strong><br>$</td>
					<td align="left">
						<li>El procesamiento asíncrono (paso 6) es fundamental para la experiencia del usuario y la estabilidad del
							sistema. Una exportación síncrona bloquearía el navegador y podría causar timeouts en la solicitud HTTP.
						</li>
						<li>Por motivos de seguridad de datos, los enlaces de descarga generados (paso 9) deben ser de un solo uso o
							tener un tiempo de expiración corto. </li>
					<br>$</td>
				</tr>
				<tr>
					<td>$<br>$</td>
					<td>$<br>$</td>
				</tr>
				<tr>
					<td>$<br>$</td>
					<td>$<br>$</td>
				</tr>
			</tbody>
			<thead>
				<tr>
					<th align="left"><strong>ID del Caso de Uso</strong></th>
					<th align="left">UC-2 1</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td align="left"> <strong>Nombre</strong><br>$</td>
					<td align="left"> Visualizar Dashboard de Métricas<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Actor Primario</strong><br>$</td>
					<td align="left"> Agente Especialista<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Actor Secundario(s)</strong><br>$</td>
					<td align="left"> Agente triaje, Administrador<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Objetivos asociados</strong><br>$</td>
					<td align="left">
						<ol>
							<li><strong>Generar Inteligencia de Negocio:</strong> Ofrecer una vista consolidada para identificar
								tendencias, cuellos de botella y áreas de mejora en el proceso de soporte. </li>
							<li><strong>Optimizar la Eficiencia Operativa:</strong> Facilitar el seguimiento del rendimiento
								individual y del equipo frente a los KPIs para soportar la toma de decisiones basada en datos. </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Requisitos asociados</strong><br>$</td>
					<td align="left"> <strong>Funcionales:</strong>
						<ul>
							<li><strong>RF-ADMIN-004:</strong> Un Administrador debe poder visualizar dashboards de rendimiento.
							</li>
							<li><strong>RF-AGENT-009:</strong> El sistema debe monitorizar SLAs y resaltar visualmente los
								tickets.<br><br><strong>Interfaces:</strong> </li>
							<li><strong>UI-0 1:</strong> Dashboard de Administrador con KPIs clave. </li>
							<li><strong>UI-02 / UI-03:</strong> Paneles de agente que incluyen indicadores de SLA. </li>
						</ul>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Descripción</strong><br>$</td>
					<td align="left"> Un usuario autorizado (Agente, Administrador) accede a una sección dedicada en
						la interfaz web para visualizar un panel de control con métricas y KPIs sobre la operación de soporte. La
						información presentada se filtra automáticamente según el rol y los permisos del usuario.<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Precondición</strong><br>$</td>
					<td align="left">
						<ol>
							<li>El usuario está autenticado en el sistema. </li>
							<li>El usuario tiene al menos permisos de <code>Agente Especialista</code>. </li>
							<li>Existen datos de tickets en el sistema para ser analizados y mostrados. </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Secuencia Normal (Flujo Principal)</strong><br>$</td>
					<td align="left">
						<ol>
							<li>El <strong>Usuario</strong> navega a la sección "Dashboard" o "Métricas" a través del menú principal
								de la aplicación. </li>
							<li>El <strong>Sistema</strong> identifica el rol del usuario (Agente, Administrador). </li>
							<li>El <strong>Sistema</strong> recupera los datos operativos relevantes de la base de datos, aplicando
								los filtros de permisos correspondientes:
							</li>
							<li> <strong>Agente:</strong> Métricas personales (mis tickets asignados, mi tiempo de respuesta, etc.).
							</li>
							<li> <strong>Administrador:</strong> Métricas agregadas de su equipo y métricas individuales de los
								agentes
								bajo su cargo. </li>
							<li> <strong>Administrador:</strong> Métricas globales de todo el sistema. </li>
							<li>El <strong>Sistema</strong> presenta el dashboard, que contiene varios widgets visuales, tales como:
							</li>
							<ol type="a">
								<li> <strong>Tarjetas de KPIs:</strong> Tickets Abiertos, Tickets Resueltos Hoy, Tiempo Medio de Primera
									Respuesta (FRT), Tiempo Medio de Resolución (TTR), Tasa de Resolución en Primer Contacto (FCR),
									Puntuación de Satisfacción del Cliente (CSAT). </li>
								<li> <strong>Gráficos de Tendencia:</strong> Un gráfico de líneas mostrando el volumen de tickets
									creados
									vs. resueltos en los últimos 7/30 días.<br>
								</li>
								<li><strong>Listas de Prioridad:</strong> Una lista de los tickets más antiguos sin resolver o aquellos
									que están a punto de incumplir su SLA. </li>
							</ol>

							<li>El <strong>Usuario</strong> puede interactuar con el dashboard para refinar la vista, por ejemplo,
								cambiando el rango de fechas (hoy, últimos 7 días, último mes). </li>
							<li>Si el usuario es Administrador, puede filtrar las métricas por agente o por equipo. </li>
						</ol>

					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Postcondición</strong><br>$</td>
					<td align="left">
						<ol>
							<li>El usuario ha visualizado el estado actual y el rendimiento histórico de la operación de soporte, de
								acuerdo con sus permisos.</li>
							<li>El estado del sistema no se ha modificado (es una operación de solo lectura). </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Excepciones (Flujos Alternativos)</strong><br>$</td>
					<td align="left">
						<ul>
							<strong>E1: No hay datos disponibles para el período seleccionado.</strong>
							<li> En el paso 5, el usuario selecciona un rango de fechas en el que no hubo actividad. </li>
							<li> El Sistema, en lugar de mostrar gráficos vacíos o errores, presenta un mensaje claro en cada widget
								afectado: "No hay datos disponibles para el período seleccionado".<br><br>
								<strong>E2: Error al cargar
									los datos del dashboard.</strong>
							</li>
							<li> En el paso 3, el backend no puede recuperar o procesar los datos (ej. por un error en la base de
								datos).</li>
							<li> El Sistema muestra un mensaje de error general en el área del dashboard: "No se pudieron cargar las
								métricas. Por favor, intente recargar la página." y registra el error técnico internamente.
							</li>
						</ul>
						<ul>

						</ul>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Rendimiento</strong><br>$</td>
					<td align="left"> La carga inicial del dashboard con los datos del período predeterminado (ej. "últimos 7
						días") debe completarse en <strong>menos de 5 segundos</strong>. Las operaciones de filtrado deben
						actualizar la vista en <strong>menos de 3 segundos</strong>.<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Frecuencia</strong><br>$</td>
					<td align="left"> Alta. Se espera que sea una de las primeras pantallas que los Administradores
						consulten diariamente. Los agentes la consultarán periódicamente para autoevaluar su rendimiento.<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Comentarios</strong><br>$</td>
					<td align="left">
						<li>Para optimizar el rendimiento (NFR-PERF), los cálculos de métricas complejas no deben realizarse en
							tiempo real sobre la base de datos transaccional en cada carga. Se debe considerar una estrategia de
							pre-agregación (ej. tablas de resumen actualizadas periódicamente) para garantizar tiempos de carga
							rápidos.
						</li>
					<br>$</td>

				</tr>
				<tr>
					<td>$<br>$</td>
					<td>$<br>$</td>
				</tr>
				<tr>
					<td>$<br>$</td>
					<td>$<br>$</td>
				</tr>
			</tbody>
			<thead>
				<tr>
					<th align="left"><strong>ID del Caso de Uso</strong></th>
					<th align="left">UC-22</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td align="left"> <strong>Nombre</strong><br>$</td>
					<td align="left"> Auditar Log de Eventos del Sistema<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Actor Primario</strong><br>$</td>
					<td align="left"> Administrador<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Objetivos asociados</strong><br>$</td>
					<td align="left">
						<ol>
							<li><strong>Mitigación de Riesgos Operativos:</strong> Garantizar la trazabilidad y rendición de cuentas a
								través de un registro inmutable de acciones críticas, facilitando la auditoría de seguridad y la
								depuración de problemas. </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Requisitos asociados</strong><br>$</td>
					<td align="left"> <strong>Funcionales:</strong>
						<ul>
							<li><strong>RF-ADMIN-002:</strong> Un administrador debe poder auditar los cambios en las configuraciones
								de los agentes de IA.<br><br><strong>No Funcionales:</strong> </li>
							<li><strong>NFR-SEC-00 1:</strong> El acceso a los endpoints debe estar protegido (este es un endpoint de
								alta sensibilidad). </li>
						</ul>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Descripción</strong><br>$</td>
					<td align="left"> El Administrador accede a una interfaz segura que muestra un registro cronológico de todos
						los eventos significativos que han ocurrido en el sistema. Puede buscar y filtrar estos registros para
						realizar auditorías de seguridad, monitorizar la actividad de los usuarios o diagnosticar problemas
						técnicos.<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Precondición</strong><br>$</td>
					<td align="left">
						<ol>
							<li>El usuario está autenticado en el sistema. </li>
							<li>El usuario tiene asignado el rol de <code>Administrador</code>. </li>
							<li>El sistema está configurado para registrar eventos en una tabla o servicio de logs
								(<code>LogEvento</code>). </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Secuencia Normal (Flujo Principal)</strong><br>$</td>
					<td align="left">
						<ol>
							<li>El <strong>Administrador</strong> navega a la sección "Administración" &gt; "Auditoría" o "Log de
								Eventos". </li>
							<li>El <strong>Sistema</strong> presenta una vista de tabla con el log de eventos, ordenado por fecha
								descendente (los más recientes primero). Cada fila representa un evento y muestra información clave
								como:
							</li>
							<li> <strong>Timestamp:</strong> Fecha y hora exactas del evento (en UTC).<br>
							</li>
							<li><strong>Usuario:</strong> El usuario que realizó la acción (o "Sistema" si fue una acción automática).
							</li>

							<li> <strong>Tipo de Evento:</strong> Una acción descriptiva (ej. <code>LOGIN_SUCCESS</code>,
								<code>USER_CREATED</code>, <code>CONFIG_AGENT_UPDATED</code>, <code>TICKET_DELETED</code>).
							</li>
							<li> <strong>Entidad Afectada:</strong> El tipo de objeto que fue modificado (ej. <code>Usuario</code>,
								<code>Ticket</code>, <code>ConfigAgente</code>).
							</li>
							<li> <strong>ID de la Entidad:</strong> El identificador único del objeto afectado. </li>
							<li>El <strong>Administrador</strong> utiliza los controles de filtrado para acotar la búsqueda. Puede
								filtrar por: </li>
							<ol type="a">
								<li> Rango de fechas. </li>
								<li> Usuario específico. </li>
								<li> Tipo de evento. </li>
							</ol>
							<li>El <strong>Administrador</strong> aplica los filtros y el <strong>Sistema</strong> actualiza la tabla
								para mostrar solo los eventos que coinciden con los criterios. </li>
							<li>El <strong>Administrador</strong> hace clic en una fila de un evento para ver más detalles. </li>
							<li>El <strong>Sistema</strong> muestra una vista detallada (ej. en un modal) con toda la información del
								evento, que puede incluir: </li>
							<ol type="a">
								<li> Dirección IP de origen. </li>
								<li> Agente de usuario (navegador).<br>
								</li>
								<li>Datos completos del cambio (ej. un "diff" o los valores "antes" y "después" de una modificación de
									configuración).</li>
							</ol>
						</ol>

					<br>$</td>

				</tr>
				<tr>
					<td align="left"> <strong>Postcondición</strong><br>$</td>
					<td align="left">
						<ol>
							<li>El Administrador ha podido consultar y analizar la actividad del sistema para su propósito de
								auditoría o investigación.</li>
							<li>El log de eventos no ha sido modificado. La interfaz no permite la alteración o eliminación de
								registros de auditoría.</li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Excepciones (Flujos Alternativos)</strong><br>$</td>
					<td align="left">
						<ul>
							<strong>E1: La búsqueda no devuelve resultados.</strong>
							<li> En el paso 4, los filtros aplicados por el Administrador no coinciden con ningún evento en la base de
								datos.</li>
							<li> El Sistema muestra un mensaje claro en el área de la tabla: "No se encontraron eventos que coincidan
								con los criterios de búsqueda".<br><br>
								<strong>E2: El log de eventos es demasiado grande para mostrarlo
									de una vez.</strong><br>
							</li>
							<li>El Sistema no intentará cargar millones de registros en el navegador. La interfaz implementará
								paginación por defecto (ej. mostrando 25 o 50 eventos por página) para manejar grandes volúmenes de
								datos de manera eficiente. El Administrador podrá navegar entre las páginas.
							</li>
						</ul>

						<ul>

						</ul>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Rendimiento</strong><br>$</td>
					<td align="left"> Las consultas y filtrados sobre el log de eventos deben ejecutarse y mostrar resultados en
						<strong>menos de 5 segundos</strong>, incluso con un volumen de datos de varios meses.
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Frecuencia</strong><br>$</td>
					<td align="left"> Baja. Este caso de uso es para tareas específicas de administración, seguridad o depuración,
						no para operaciones diarias.<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Comentarios</strong><br>$</td>
					<td align="left">
						<li><strong>Inmutabilidad:</strong> El principio fundamental de un log de auditoría es su inmutabilidad.
							Bajo ninguna circunstancia la aplicación debe permitir la modificación o eliminación de entradas del log a
							través de esta interfaz. </li>
						<li><strong>Indexación:</strong> La tabla de la base de datos que almacena los logs (<code>LogEvento</code>)
							debe estar correctamente indexada por <code>timestamp</code>, <code>usuarioId</code> y
							<code>tipoDeEvento</code> para garantizar el rendimiento de las búsquedas.
						</li>
						<li><strong>Eventos a Registrar:</strong> Se deben registrar como mínimo los siguientes eventos:
							inicios/cierres de sesión, cambios en usuarios/roles, actualizaciones de configuraciones críticas
							(<code>ConfigAgente</code>, <code>Integracion</code>), importaciones/exportaciones de datos, y acciones de
							borrado de entidades principales. </li>

					<br>$</td>
				</tr>
				<tr>
					<td>$<br>$</td>
					<td>$<br>$</td>
				</tr>
				<tr>
					<td>$<br>$</td>
					<td>$<br>$</td>
				</tr>
			</tbody>
			<thead>
				<tr>
					<th align="left"><strong>ID del Caso de Uso</strong></th>
					<th align="left">UC-23</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td align="left"> <strong>Nombre</strong><br>$</td>
					<td align="left"> Crear Ticket<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Actor Primario</strong><br>$</td>
					<td align="left"> Sistema<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Actor Secundario(s)</strong><br>$</td>
					<td align="left"> <strong>Sistema</strong> (Invoca <code>UC-24: Generar Sugerencia de Respuesta</code>)<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Objetivos asociados</strong><br>$</td>
					<td align="left">
						<ol>
							<li><strong>Optimizar la Eficiencia Operativa:</strong> Centralizar la lógica para garantizar que todos
								los tickets, sin importar su origen, se creen de manera consistente y entren correctamente en el flujo
								de trabajo. </li>
							<li><strong>Mitigación de Riesgos Operativos:</strong> Asegurar la integridad de los datos al vincular
								correctamente el ticket con un cliente, mensaje y orden. </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Requisitos asociados</strong><br>$</td>
					<td align="left"> <strong>Funcionales:</strong>
						<ul>
							<li><strong>RF-TICKET-00 1, 002, 008:</strong> Implementa la lógica de creación para múltiples canales.
							</li>
							<li><strong>RF-TICKET-004:</strong> Lógica de <code>UPSERT</code> (crear o actualizar) para el
								<code>Cliente</code>.
							</li>
							<li><strong>RF-TICKET-005:</strong> Lógica de vinculación a una <code>Orden</code>. </li>
							<li><strong>RF-FILE-002:</strong> Lógica para almacenar
								<code>Archivo</code>s.<br><br><strong>Dependencias:</strong>
							</li>
							<li>Depende de los servicios de Base de Datos y Almacenamiento (Supabase Storage). </li>
						</ul>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Descripción</strong><br>$</td>
					<td align="left"> Este es un proceso interno y reutilizable que es invocado por otros casos de uso
						(<code>UC-0 1</code>, <code>UC-25</code>) para manejar la creación de un nuevo <code>Ticket</code> de
						soporte. Recibe un conjunto de datos (información del cliente, mensaje, adjuntos), los valida, y crea los
						registros correspondientes en la base de datos, dejando el ticket listo para el siguiente paso del flujo: el
						análisis por IA.<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Precondición</strong><br>$</td>
					<td align="left">
						<ol>
							<li>Otro proceso del sistema ha invocado este caso de uso. </li>
							<li>Se ha proporcionado un payload de datos que contiene, como mínimo, un email de remitente y el
								contenido del mensaje.</li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Secuencia Normal (Flujo Principal)</strong><br>$</td>
					<td align="left">
						<ol>
							<li>El <strong>Sistema</strong> recibe los datos del ticket a crear (ej. <code>nombre</code>,
								<code>email</code>, <code>asunto</code>, <code>cuerpo</code>, <code>archivos adjuntos</code>,
								<code>canal de origen</code>).
							</li>
							<li>El <strong>Sistema</strong> realiza una validación de seguridad y de negocio de los datos (ej. sanea
								el HTML del cuerpo, verifica el formato del email). </li>
							<li>El <strong>Sistema</strong> busca un <code>Cliente</code> en la base de datos usando el
								<code>email</code>.
							</li>
							<li><strong>Si no existe</strong>, crea un nuevo registro de <code>Cliente</code> con el
								<code>email</code> y el <code>nombre</code> proporcionados.
							</li>
							<li><strong>Si existe</strong>, utiliza el <code>Cliente</code> encontrado. </li>
							<li>El <strong>Sistema</strong> crea un nuevo registro de <code>Ticket</code> en la base de datos,
								asociándolo al ID del <code>Cliente</code>, y establece su estado inicial como
								<code>pendiente_ia</code>.
							</li>
							<li>Si se proporcionó un ID de <code>Orden</code> en los datos de entrada, el <strong>Sistema</strong>
								busca la orden y, si la encuentra, la asocia al <code>Ticket</code>. </li>
							<li>El <strong>Sistema</strong> crea un registro de <code>Mensaje</code> con el contenido del
								<code>asunto</code> y <code>cuerpo</code>, asociándolo al <code>Ticket</code> recién creado.
							</li>
							<li><strong>Si hay archivos adjuntos:</strong> </li>
							<ol type="a">
								<li>Para cada archivo, el <strong>Sistema</strong> lo sube al proveedor de almacenamiento (Supabase
									Storage) a través de su API. </li>
								<li>Tras una subida exitosa, el <strong>Sistema</strong> crea un registro <code>Archivo</code> en la
									base
									de datos con la URL de almacenamiento y los metadatos del archivo. </li>
								<li>Asocia cada registro <code>Archivo</code> al <code>Mensaje</code> creado en el paso 6. </li>
							</ol>
							<li>El <strong>Sistema</strong> devuelve una confirmación de éxito (con el ID del nuevo ticket) al proceso
								que lo invocó. </li>
						</ol>
					<br>$</td>
				</tr>

				<tr>
					<td align="left"> <strong>Postcondición</strong><br>$</td>
					<td align="left">
						<ol>
							<li>Se han creado los registros <code>Cliente</code> (si era nuevo), <code>Ticket</code>,
								<code>Mensaje</code> y <code>Archivo</code> (si aplica) en la base de datos.
							</li>
							<li>El <code>Ticket</code> está en estado <code>pendiente_ia</code>. </li>
							<li>El proceso que invocó a <code>UC-23</code> puede continuar su ejecución (ej. enviar el acuse de
								recibo). </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Excepciones (Flujos Alternativos)</strong><br>$</td>
					<td align="left">
						<ul>
							<strong>E1: Datos de entrada inválidos.</strong>
							<li> En el paso 2, los datos son insuficientes o malformados (ej. falta el email). </li>
							<li> El proceso falla y devuelve un error al invocador. No se crea ningún registro en la base de
								datos.<br><br>
								<strong>E2: Falla la conexión con la base de datos.</strong>
							</li>
							<li> En los pasos 3-7, el sistema no puede comunicarse con la base de datos. </li>
							<li> El proceso falla, revierte cualquier transacción parcial (rollback) y devuelve un error grave al
								invocador.<br><br>
								<strong>E3: Falla la subida de un archivo adjunto.</strong>
							</li>
							<li> En el paso 7a, el servicio de almacenamiento no está disponible o rechaza el archivo. </li>
							<li> El ticket y el mensaje se crean igualmente, pero se registra un error interno indicando que el
								archivo no pudo ser procesado. El proceso puede continuar, pero con una advertencia.
							</li>
						</ul>
						<ul>

						</ul>
					<br>$</td>
				</tr>
				<tr>
					<td>$<br>$</td>
					<td>$<br>$</td>
				</tr>
				<tr>
					<td>$<br>$</td>
					<td>$<br>$</td>
				</tr>
			</tbody>
			<thead>
				<tr>
					<th align="left"><strong>ID del Caso de Uso</strong></th>
					<th align="left">UC-24</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td align="left"> <strong>Nombre</strong><br>$</td>
					<td align="left"> Generar Sugerencia de Respuesta<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Actor Primario</strong><br>$</td>
					<td align="left"> Sistema<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Actor Secundario(s)</strong><br>$</td>
					<td align="left"> <strong>Proveedor LLM (OpenRouter)</strong><br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Objetivos asociados</strong><br>$</td>
					<td align="left">
						<ol>
							<li><strong>Optimizar la Eficiencia Operativa:</strong> Automatizar el análisis inicial y reducir la carga
								cognitiva del agente al proveer un borrador de respuesta y etiquetas sugeridas. </li>
							<li><strong>Escalar las Operaciones de Soporte:</strong> Aplicar reglas de negocio automáticas (ej.
								escalado) basadas en el análisis de la IA. </li>
							<li><strong>Reducir el Desgaste del Agente (Agent Burnout):</strong> Asistir al agente en las tareas más
								repetitivas del triaje de tickets. </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Requisitos asociados</strong><br>$</td>
					<td align="left"> <strong>Funcionales:</strong>
						<ul>
							<li><strong>RF-IA-00 1:</strong> Inicia este proceso tras la creación de un ticket. </li>
							<li><strong>RF-IA-002:</strong> Utiliza la <code>ConfigAgente</code> para construir el prompt. </li>
							<li><strong>RF-IA-003:</strong> Almacena la respuesta del LLM en el <code>Ticket</code>.
							</li>
							<li>
								<strong>RF-IA-004:</strong> Cambia el estado del ticket a <code>ia_sugerido</code>.
							</li>
							<li>
								<strong>RF-IA-005:</strong> Implementa la lógica de escalado
								automático.<br><br><strong>Interfaces:</strong>
							</li>
							<li><strong>API-03:</strong> Se comunica con la API de OpenRouter. </li>
							<li><strong>COM-02:</strong> Notifica al frontend vía SSE/WebSocket. </li>
						</ul>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Descripción</strong><br>$</td>
					<td align="left"> Este proceso asíncrono se activa después de la creación de un ticket. El sistema recopila
						todo el contexto relevante del ticket, selecciona la configuración de agente IA apropiada, construye un
						prompt y lo envía a un servicio LLM externo. Al recibir la respuesta, la procesa, actualiza el ticket con
						las sugerencias y cambia su estado para que aparezca en la cola de triaje.
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Precondición</strong><br>$</td>
					<td align="left">
						<ol>
							<li>Un <code>Ticket</code> existe en la base de datos en estado <code>pendiente_ia</code>. </li>
							<li>Las credenciales de la API del Proveedor LLM están configuradas y son válidas. </li>
							<li>Existe al menos una <code>ConfigAgente</code> activa en el sistema. </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Secuencia Normal (Flujo Principal)</strong><br>$</td>
					<td align="left">
						<ol>
							<li>El <strong>Sistema</strong> (a través de un worker de tareas en segundo plano) recoge un
								<code>Ticket</code> del estado <code>pendiente_ia</code>.
							</li>
							<li>El <strong>Sistema</strong> consulta la base de datos para obtener el contexto completo: el
								<code>Mensaje</code> inicial, datos del <code>Cliente</code> (incluido su historial si es relevante) y
								detalles de la <code>Orden</code> si está vinculada.
							</li>
							<li>El <strong>Sistema</strong> selecciona la <code>ConfigAgente</code> más adecuada (ej. "Agente de
								Devoluciones") basándose en palabras clave del asunto o cuerpo del mensaje. Si no encuentra una
								específica, usa la configuración por defecto. </li>
							<li>El <strong>Sistema</strong> construye el prompt final, inyectando el contexto recopilado en la
								plantilla de la <code>ConfigAgente</code> seleccionada. </li>
							<li>El <strong>Sistema</strong> realiza una llamada a la API del <strong>Proveedor LLM</strong>
								(<code>API-03</code>), enviando el prompt. </li>
							<li>El <strong>Proveedor LLM</strong> procesa la solicitud y devuelve una respuesta estructurada (JSON)
								que contiene el texto de la respuesta sugerida, un nivel de confianza, etiquetas sugeridas y una bandera
								de escalado (<code>escalate: true/false</code>). </li>
							<li>El <strong>Sistema</strong> recibe y valida la respuesta del LLM. </li>
							<li>El <strong>Sistema</strong> actualiza el registro del <code>Ticket</code> en la base de datos,
								guardando la información recibida en los campos <code>respuestaSugeridaIA</code>,
								<code>confianzaIA</code>, <code>etiquetasSugeridasIA</code>, etc.
							</li>
							<li>El <strong>Sistema</strong> aplica la lógica de escalado automático (<code>RF-IA-005</code>).
							</li>
							<ul>
								<li><strong>Si</strong> se cumple alguna condición de escalado (ej. <code>escalate: true</code>,
									confianza
									baja, palabras clave sensibles, adjunto de imagen), el estado del ticket se cambia a
									<code>escalado_nivel_2</code>.
								</li>
								<li><strong>Si no</strong>, el estado del ticket se cambia a <code>ia_sugerido</code>. </li>
							</ul>
							<li>El <strong>Sistema</strong> emite un evento en tiempo real (<code>COM-02</code>) para notificar a las
								interfaces de usuario que el ticket ha sido actualizado y está listo para revisión. </li>
						</ol>
					<br>$</td>
				</tr>

				<tr>
					<td align="left"> <strong>Postcondición</strong><br>$</td>
					<td align="left">
						<ol>
							<li>El <code>Ticket</code> se ha actualizado con las sugerencias de la IA. </li>
							<li>El estado del <code>Ticket</code> es ahora <code>ia_sugerido</code> o <code>escalado_nivel_2</code>.
							</li>
							<li>El ticket es visible en la cola de trabajo correspondiente (Triaje o Especialista). </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Excepciones (Flujos Alternativos)</strong><br>$</td>
					<td align="left">
						<ul>
							<strong>E1: Falla la comunicación con el Proveedor LLM.</strong>
							<li> En el paso 5, la API del LLM no está disponible o devuelve un error. </li>
							<li> El Sistema reintenta la llamada un número configurable de veces. Si todos los intentos fallan, cambia
								el estado del <code>Ticket</code> a <code>error_ia</code> y notifica a los
								administradores.<br><br>
								<strong>E2: El Proveedor LLM tarda demasiado en responder.</strong>
							</li>
							<li> En el paso 6, se excede el tiempo de espera (timeout). </li>
							<li> El Sistema trata esto como una falla de comunicación (ver E 1).<br><br>
								<strong>E3: La respuesta del
									LLM es inválida.</strong>
							</li>
							<li> En el paso 7, la respuesta no es un JSON válido o carece de los campos esperados. </li>
							<li> El Sistema no puede procesar la respuesta. Cambia el estado del <code>Ticket</code> a
								<code>error_ia</code> y registra el contenido de la respuesta inválida para su depuración.
							</li>
						</ul>
					<br>$</td>
				</tr>
				<tr>
					<td>$<br>$</td>
					<td>$<br>$</td>
				</tr>
				<tr>
					<td>$<br>$</td>
					<td>$<br>$</td>
				</tr>
			</tbody>
			<thead>
				<tr>
					<th align="left"><strong>ID del Caso de Uso</strong></th>
					<th align="left">UC-25</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td align="left"> <strong>Nombre</strong><br>$</td>
					<td align="left"> Notificar Nuevo Email<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Actor Primario</strong><br>$</td>
					<td align="left"> Sistema de Email (Mailgun)<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Actor Secundario(s)</strong><br>$</td>
					<td align="left"> <strong>Sistema</strong> (Para la orquestación y decisión de invocar <code>UC-23</code> o
						<code>UC-03</code>)
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Objetivos asociados</strong><br>$</td>
					<td align="left">
						<ol>
							<li><strong>Optimizar la Eficiencia Operativa:</strong> Orquestar el flujo de entrada, diferenciando entre
								nuevos tickets y respuestas para prevenir la duplicación y mantener conversaciones ordenadas. </li>
							<li><strong>Mitigación de Riesgos Operativos:</strong> Actuar como un punto de entrada seguro y fiable
								para todo el soporte basado en correo electrónico. </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Requisitos asociados</strong><br>$</td>
					<td align="left"> <strong>Funcionales:</strong>
						<ul>
							<li><strong>RF-TICKET-00 1:</strong> Desencadena la creación de un ticket para nuevos correos. </li>
							<li><strong>RF-TICKET-003:</strong> Implementa la lógica de enrutamiento para correos de
								respuesta.<br><br><strong>Interfaces:</strong> </li>
							<li><strong>API-02:</strong> Define la existencia de este endpoint de webhook. </li>
						</ul>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Descripción</strong><br>$</td>
					<td align="left"> Este proceso se inicia cuando el proveedor de correo externo (Mailgun) notifica al sistema,
						a través de un webhook, sobre la llegada de un nuevo correo electrónico. El sistema recibe los datos del
						correo, determina si corresponde a un ticket nuevo o a una respuesta de un ticket existente, e invoca el
						caso de uso apropiado para su procesamiento.<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Precondición</strong><br>$</td>
					<td align="left">
						<ol>
							<li>El webhook de Mailgun está correctamente configurado para apuntar al endpoint
								<code>POST /webhooks/mailgun/inbound</code> de NoraAI.
							</li>
							<li>El endpoint está desplegado y es accesible públicamente. </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Secuencia Normal (Flujo Principal)</strong><br>$</td>
					<td align="left">
						<ol>
							<li>El <strong>Sistema de Email</strong> recibe un correo dirigido a la dirección de soporte y envía una
								solicitud HTTP POST al endpoint del webhook de NoraAI. </li>
							<li>El <strong>Sistema</strong> recibe la solicitud y primero verifica su autenticidad (ej. mediante la
								firma de la carga útil de Mailgun) para prevenir ataques. </li>
							<li>El <strong>Sistema</strong> parsea el payload JSON para extraer las cabeceras
								(<code>In-Reply-To</code>, <code>References</code>, <code>Subject</code>) y el contenido del correo.
							</li>
							<li>El <strong>Sistema</strong> ejecuta la lógica de enrutamiento: <ol type="a">
									<li>Busca en las cabeceras <code>In-Reply-To</code> o <code>References</code> un ID de mensaje
										conocido. </li>
									<li>Si no lo encuentra, busca en el <code>Subject</code> un patrón de ID de ticket (ej.
										<code>[Ticket #ABC-123]</code>).
									</li>
									<li><strong>Si se encuentra una referencia a un ticket existente</strong> (flujo alternativo
										<code>A 1</code> que se convierte en principal para <code>UC-03</code>): <ol type="a">

											<li>El <strong>Sistema</strong> invoca el caso de uso
												<strong><code>UC-03: Responder a un Ticket (Correo) Existente</code></strong>, pasándole los
												datos
												del correo.
											</li>
											<li><strong>Si no se encuentra ninguna referencia a un ticket existente:</strong> </li>

										</ol>
									</li>
								</ol>
							</li>
						</ol>
					<br>$</td>
				</tr>

				<tr>
					<td align="left"> <strong>Postcondición</strong><br>$</td>
					<td align="left">
						<ol>
							<li>Se ha invocado el caso de uso <code>UC-23</code> o <code>UC-03</code>. </li>
							<li>Se ha enviado una respuesta <code>200 OK</code> al proveedor de correo, evitando que intente reenviar
								el webhook. </li>
						</ol>
					<br>$</td>
				</tr>
				<tr>
					<td align="left"> <strong>Excepciones (Flujos Alternativos)</strong><br>$</td>
					<td align="left">
						<ul>
							<strong>E1: La firma del webhook es inválida.</strong>
							<li> En el paso 2, la autenticación falla. </li>
							<li> El Sistema rechaza la solicitud con un código de error <code>403 Forbidden</code>, la ignora y
								registra un intento de acceso no autorizado.<br><br>
								<strong>E2: El payload del webhook está
									malformado.</strong>
							</li>
							<li> En el paso 3, el JSON no puede ser parseado. </li>
							<li> El Sistema responde con un código <code>400 Bad Request</code> para indicar que la solicitud del
								cliente (Mailgun) es incorrecta.<br><br>
								<strong>E3: Falla un proceso interno invocado.</strong>
							</li>
							<li> En los pasos 5 o 6, el caso de uso invocado (<code>UC-23</code> o <code>UC-03</code>) devuelve un
								error grave (ej. la base de datos está caída). </li>
							<li> El Sistema responde al webhook con un código <code>500 Internal Server Error</code>. Esto le indica a
								Mailgun que el procesamiento falló por un problema del servidor y que debe reintentar enviar el webhook
								más tarde.
							</li>
						</ul>
						<ul>

						</ul>
					<br>$</td>
				</tr>
			</tbody>
		</table>
	</div>
</body>

</html>